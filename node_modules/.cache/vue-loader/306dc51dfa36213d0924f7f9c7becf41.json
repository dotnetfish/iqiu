{"remainingRequest":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/src/views/Liveroom.vue?vue&type=style&index=0&id=d9919afe&lang=scss&scoped=true&","dependencies":[{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/src/views/Liveroom.vue","mtime":1596600786422},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/css-loader/dist/cjs.js","mtime":1595570903613},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1595570907990},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/postcss-loader/src/index.js","mtime":1595570906300},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/sass-loader/dist/cjs.js","mtime":1595570907455},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/cache-loader/dist/cjs.js","mtime":1595570902420},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/vue-loader/lib/index.js","mtime":1595570907990}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgpAaW1wb3J0ICJAL2Fzc2V0cy9jc3MvX2luZGV4LnNjc3MiOwoKLnZpZGVvLXBsYXllciB7CiAgLypwb3NpdGlvbjogYWJzb2x1dGU7Ki8KICAvKndpZHRoOiAxMDAlOyovCiAgLypoZWlnaHQ6MTAwJTsqLwp9CgoudG9wTmF2IHsKICBwb3NpdGlvbjogZml4ZWQ7CiAgei1pbmRleDogJHotaW5kZXgxOwogIHRvcDogMDsKICBsZWZ0OiAwOwogIHdpZHRoOiAxMDAlOwogIG1pbi13aWR0aDogOTQ4cHg7CiAgcGFkZGluZy1sZWZ0OiAyNDBweDsKICAvLyB0cmFuc2l0aW9uOiBhbGwgMC41czsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmOwp9CgoubWFpbi1oZWFkZXIgewogIHBvc2l0aW9uOiBmaXhlZDsKICB6LWluZGV4OiAyMTsKICB0b3A6IDA7CiAgbGVmdDogMDsKICB3aWR0aDogMTAwJTsKCiAgOjp2LWRlZXAuaG9tZS1uYXYgewogICAgLyp3aWR0aDogY2FsYygxMDAlIC0gNDgwcHgpOyovCiAgICAvKm1hcmdpbjogMCAyNDBweDsqLwogICAgLypib3gtc2l6aW5nOmJvcmRlci1ib3g7Ki8KICB9Cn0KCi5tYWluLWNvbnRhaW5lciB7CiAgcGFkZGluZy1sZWZ0OiAyNDBweDsKCiAgJi5mb2xkIHsKICAgIHBhZGRpbmctbGVmdDogNDhweDsKICB9Cn0KCi5saXZlcm9vbSB7CiAgcG9zaXRpb246IHJlbGF0aXZlOwogIHBhZGRpbmctdG9wOiA2MHB4OwogIHBhZGRpbmctcmlnaHQ6IDM3MHB4OwoKICBiYWNrZ3JvdW5kLWNvbG9yOiAkYmctbWFpbjsKICBAZXh0ZW5kICVjbGVhcmZpeDsKfQoKLm1haW4td3JhcCB7CiAgbWFyZ2luOiAyMHB4IDIwcHggMjBweCAzNXB4OwogIG1pbi13aWR0aDogNTM1cHg7CiAgLy8gZmxvYXQ6bGVmdDsKICBkaXNwbGF5OiBmbGV4OwogIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47Cn0KCi5jaGF0LXdyYXAgewogIHBvc2l0aW9uOiBmaXhlZDsKICB6LWluZGV4OiAzOwogIHJpZ2h0OiAwOwogIHRvcDogODBweDsKICBvdmVyZmxvdzogaGlkZGVuOwogIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgd2lkdGg6IDM3MHB4OwogIGhlaWdodDogMTAwJTsKCiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsKCiAgYm9yZGVyOiAxcHggc29saWQgJGNvbG9yLWJvcmRlcjsKICBib3JkZXItdG9wOiAwcHggc29saWQgJGNvbG9yLWJvcmRlcjsKICBib3JkZXItcmlnaHQ6IDBweCBzb2xpZCAkY29sb3ItYm9yZGVyOwp9CgouZW1wdHkgewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAvKmhlaWdodDogMzUwcHg7Ki8KICBiYWNrZ3JvdW5kLWNvbG9yOiAjY2NjOwogIC8vIGhhY2sg5pu05pS55by55bmV5a6a5L2N5pa55byPIOS/neivgeinhumikeWcqOaWh+aho+a1geWGhQogICYgPiA6OnYtZGVlcCBkaXY6bm90KDpvbmx5LWNoaWxkKTpsYXN0LW9mLXR5cGUgewogICAgcG9zaXRpb246IGFic29sdXRlICFpbXBvcnRhbnQ7CiAgICB6LWluZGV4OiAxOSAhaW1wb3J0YW50OwogICAgdG9wOiAwICFpbXBvcnRhbnQ7CiAgICAvKmJhY2tncm91bmQtY29sb3I6IHJlZCFpbXBvcnRhbnQ7Ki8KICB9Cn0K"},{"version":3,"sources":["Liveroom.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgvBA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Liveroom.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <section>\n    <loginPop ref=\"login\" @successLogin=\"init\"></loginPop>\n    <div :class=\"[{ fold: isFold }, 'main-header']\">\n      <homeNav :navLogo=\"true\"></homeNav>\n      <!--      <homeNav :navLogo=\"false\"></homeNav>-->\n    </div>\n    <div class=\"liveroom\" :class=\"[{ fold: isFold }, 'main-container']\">\n      <LeftSideBar @changeFoldState=\"getFoldState\"></LeftSideBar>\n      <div class=\"main-wrap\">\n        <LiveroomHeader\n          :channelInfo=\"channelInfo\"\n          v-bind:follow.sync=\"userInfo.follow\"\n          @login=\"login\"\n        ></LiveroomHeader>\n\n        <div class=\"empty\" ref=\"danmaku\" id=\"danmaku\">\n          <videoPlayer ref=\"dPlayer\" :roomId=\"liveroom\" :notLivingSuggest=\"recommendVideo2\"></videoPlayer>\n          <!--          <LiveroomPaodao :messageItem=\"messageItem\"></LiveroomPaodao>-->\n        </div>\n        <LiveroomGift\n          :userLogin=\"userLogin\"\n          :channelInfo=\"channelInfo\"\n          :giftList=\"giftList\"\n          @sendGiftSuccess=\"sendGiftSuccess\"\n          @login=\"login\"\n        ></LiveroomGift>\n        <LiveroomRecommend ref=\"recommend\" :recommendList=\"recommendList\"></LiveroomRecommend>\n      </div>\n      <div class=\"chat-wrap\">\n        <liveroomNotice :msg=\"channelInfo.notice\"></liveroomNotice>\n        <liveroomChat\n          :giftListToObject=\"giftListToObject\"\n          :hongbaoList=\"hongbaoList\"\n          :userLogin=\"userLogin\"\n          :msgList=\"msgList\"\n          :giftItem=\"giftItem\"\n          :userInfo=\"userInfo\"\n          @login=\"login\"\n          @hongBaoSuccess=\"getloginInfo\"\n        ></liveroomChat>\n        <liveroomInput :userInfo=\"userInfo\" @sendMsg=\"sendMsg\" @login=\"login\"></liveroomInput>\n        <LiveroomLoginDialog @login=\"login\"></LiveroomLoginDialog>\n      </div>\n    </div>\n    <liveroomSmallvideo></liveroomSmallvideo>\n  </section>\n</template>\n<script>\nimport LiveroomHeader from \"@/components/liveroom/LiveroomHeader\";\nimport LiveroomGift from \"@/components/liveroom/LiveroomGift\";\nimport liveroomNotice from \"@/components/liveroom/LiveroomNotice\";\n// import liveroomRank from \"@/components/liveroom/LiveroomRank\";\nimport liveroomInput from \"@/components/liveroom/LiveroomInput\";\nimport liveroomChat from \"@/components/liveroom/LiveroomChat\";\n// import LiveroomPaodao from \"@/components/liveroom/LiveroomPaodao\";\nimport LiveroomLoginDialog from \"@/components/liveroom/LiveroomLoginDialog\";\nimport LiveroomRecommend from \"@/components/liveroom/LiveroomRecommend\";\nimport liveroomSmallvideo from \"@/components/liveroom/liveroomSmallvideo.vue\"\n\nimport LeftSideBar from \"@/components/left-side-bar.vue\";\nimport homeNav from \"@/views/home/homeNav.vue\";\nimport loginPop from \"@/components/login/loginTipPopup.vue\";\nimport videoPlayer from \"@/components/video/videoPlayer.vue\";\n\nimport { md5Secret } from \"@/utils/md5.js\";\nimport * as Chat from \"@/utils/chat.js\";\nimport { event } from \"@/utils/leancloud.js\";\nimport {\n  queryRoomRanking,\n  channelInfo,\n  enterRoom,\n  getGiftList,\n  loginInfo\n} from \"@/api/liveroom\";\nimport { recommendLiveList } from \"@/api/api\";\n\nimport { debounce } from \"@/utils/debounceAndthrottle\";\n// import Cookies from 'js-cookie';\nimport Danmaku from \"danmaku\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nexport default {\n  name: \"LiveRoom\",\n  components: {\n    LiveroomHeader,\n    LiveroomGift,\n    liveroomChat,\n    // LiveroomPaodao,\n    liveroomNotice,\n    // liveroomRank,\n    LiveroomLoginDialog,\n    liveroomInput,\n    LiveroomRecommend,\n    liveroomSmallvideo,\n    LeftSideBar,\n    homeNav,\n    loginPop,\n    videoPlayer\n  },\n  data() {\n    return {\n      flag: 3,\n      isFold: true,\n      userLogin: {\n        // \"id\": \"6806129\",\n        // \"token\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJ4LXp5LXVzZXItaWQiOiI2ODA2MTI5IiwiaXNzIjoiemhhbmd5dSIsImV4cCI6MTU3OTUxOTY0MiwiaWF0IjoxNTc4MzEwMDQyfQ.VU2NbKftvSJTRe1tTcXtRoWW4UnGg36gGGbHq3KgSBfhDLNjptkLsYPNyhsU_lpaZJ97Hq4LnA8Q8ThgPmAtnQ\",\n        // \"mobile\": \"184****6272\",\n        // \"uname\": \"足球精英\",\n        // \"status\": 0,\n        // \"avatarUrl\": \"https://pic.imifan.live/avatar/2019121013081813608091574583384.jpg\",\n        // \"accountDto\": {\n        //   \"_id\": \"13183057850163215\",\n        //   \"uid\": \"6806129\",\n        //   \"cashAccount\": {\n        //     \"totalBalance\": 9011,\n        //     \"balance\": 9011,\n        //     \"frzBalance\": 0,\n        //     \"totalRecharge\": 12000,\n        //     \"totalWithdrawal\": 10000\n        //   },\n        //   \"salaryAccount\": {\n        //     \"totalBalance\": 6000,\n        //     \"balance\": 5000,\n        //     \"frzBalance\": 1000,\n        //     \"totalRecharge\": 0,\n        //     \"totalWithdrawal\": 0\n        //   },\n        //   \"cashAssets\": 8011,\n        //   \"miCoin\": {\n        //     \"balance\": 379898800,\n        //     \"totalExpend\": 1099998,\n        //     \"totalRecharge\": 1099998\n        //   },\n        //   \"cashTotalRecharge\": 1111998,\n        //   \"cashTotalWithdrawal\": 10000\n        // },\n        // \"isAnchor\": true,\n        // \"favorite\": 1,\n        // \"wxBindStatus\": \"BIND\",\n        // \"wxName\": \"mimo\",\n        // \"canEditUname\": true,\n        // \"logOutStatus\": \"INAUDIT\"\n      },\n      liveroom: \"\",\n      channelInfo: {}, // 主播信息\n      userInfo: {\n        channelRoleType: 0,\n        follow: false,\n        forbid: false,\n        forbidEndTime: null\n      }, // 用户在当前直播间信息\n      giftList: [], // 礼物列表\n      giftListToObject: {}, // 礼物列表\n      hongbaoList: [], // 红包列表\n      recommendList: [], // 推荐列表\n      recommendVideo2: [], // 未开播推荐列表\n      rankObject: {},\n      messageItem: {},\n      giftItem: {\n        // \"gift\": {\n        //   \"anchorId\": \"6919164\",\n        //   \"anchorName\": \"冯曦妤\",\n        //   \"id\": 12915206930636802,\n        //   \"name\": \"浪味仙\",\n        //   \"number\": 1,\n        //   \"picture\": \"https://pic.imifan.live/gifts/langXianXian/2019101819283913031452620677141.png\",\n        //   \"showGift\": true,\n        //   \"totalFee\": 10\n        // },\n        // \"pType\": 0,\n        // \"pid\": \"6919164\",\n        // \"sign\": \"286403A393C275046C3053CA7EBE4ADD\",\n        // \"user\": {\n        //   \"avatar\": \"https://pic.imifan.live/avatar/2019103119455113183057850163209.png\",\n        //   \"id\": \"3486074\",\n        //   \"name\": \"晨曦吻月\"\n        // }\n      },\n      msgList: [\n        // 四种角色发送弹幕\n        // {\"_lcattrs\":{\"pType\":0,\"sign\":\"37D9109E305705375A2960BEB3000222\",\"lcuid\":\"CHAT_USER_3506329\",\"pid\":\"10000004\",\"user\":{\"role\":0,\"name\":\"春暖花开567\",\"id\":\"10000004\"}},\"_lctype\":-1,\"_lctext\":\"主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1\"},\n        // {\"_lcattrs\":{\"pType\":0,\"sign\":\"37D9109E305705375A2960BEB3000222\",\"lcuid\":\"CHAT_USER_3506329\",\"pid\":\"10000157\",\"user\":{\"role\":1,\"name\":\"春暖花开567\",\"id\":\"3506329\"}},\"_lctype\":-1,\"_lctext\":\"主播早1\"},\n        // {\"_lcattrs\":{\"pType\":0,\"sign\":\"37D9109E305705375A2960BEB3000222\",\"lcuid\":\"CHAT_USER_3506329\",\"pid\":\"10000157\",\"user\":{\"role\":2,\"name\":\"春暖花开567\",\"id\":\"3506329\"}},\"_lctype\":-1,\"_lctext\":\"主播早2\"},\n        // {\"_lcattrs\":{\"pType\":0,\"sign\":\"37D9109E305705375A2960BEB3000222\",\"lcuid\":\"CHAT_USER_3506329\",\"pid\":\"10000157\",\"user\":{\"role\":9,\"name\":\"春暖花开567\",\"id\":\"3506329\"}},\"_lctype\":-1,\"_lctext\":\"主播早3\"},\n        // {\"_lcattrs\":{\"gift\":{\"anchorId\":\"6336335\",\"anchorName\":\"老牛解说\",\"id\":12915206930636801,\"name\":\"饭团\",\"number\":1,\"picture\":\"https://pic.imifan.live/gifts/riceBall/2019101819132913031452620677128.png\",\"showGift\":true,\"totalFee\":10},\"pType\":0,\"pid\":\"6336335\",\"sign\":\"F5AE7BF879696F2ECE83AADD2359E229\",\"user\":{\"avatar\":\"https://pic.imifan.live/avatar/2019111210320013250427765727273.jpg\",\"id\":\"6741398\",\"name\":\"凉白开\"}},\"_lctext\":\"12915206930636801\",\"_lctype\":2}, {\"_lcattrs\":{\"pType\":0,\"sign\":\"37D9109E305705375A2960BEB3000222\",\"lcuid\":\"CHAT_USER_3506329\",\"pid\":\"10000157\",\"user\":{\"role\":0,\"name\":\"春暖花开567\",\"id\":\"3506329\"}},\"_lctype\":-1,\"_lctext\":\"主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1主播早1\"},\n        // {\"_lcattrs\":{\"pType\":0,\"sign\":\"37D9109E305705375A2960BEB3000222\",\"lcuid\":\"CHAT_USER_3506329\",\"pid\":\"10000157\",\"user\":{\"role\":1,\"name\":\"春暖花开567\",\"id\":\"3506329\"}},\"_lctype\":-1,\"_lctext\":\"主播早1\"},\n        // {\"_lcattrs\":{\"pType\":0,\"sign\":\"37D9109E305705375A2960BEB3000222\",\"lcuid\":\"CHAT_USER_3506329\",\"pid\":\"10000157\",\"user\":{\"role\":2,\"name\":\"春暖花开567\",\"id\":\"3506329\"}},\"_lctype\":-1,\"_lctext\":\"主播早2\"},\n        // {\"_lcattrs\":{\"pType\":0,\"sign\":\"37D9109E305705375A2960BEB3000222\",\"lcuid\":\"CHAT_USER_3506329\",\"pid\":\"10000157\",\"user\":{\"role\":9,\"name\":\"春暖花开567\",\"id\":\"3506329\"}},\"_lctype\":-1,\"_lctext\":\"主播早3\"},\n        // {\"_lcattrs\":{\"gift\":{\"anchorId\":\"6336335\",\"anchorName\":\"老牛解说\",\"id\":12915206930636801,\"name\":\"饭团\",\"number\":1,\"picture\":\"https://pic.imifan.live/gifts/riceBall/2019101819132913031452620677128.png\",\"showGift\":true,\"totalFee\":10},\"pType\":0,\"pid\":\"6336335\",\"sign\":\"F5AE7BF879696F2ECE83AADD2359E229\",\"user\":{\"avatar\":\"https://pic.imifan.live/avatar/2019111210320013250427765727273.jpg\",\"id\":\"6741398\",\"name\":\"凉白开\"}},\"_lctext\":\"12915206930636801\",\"_lctype\":2},\n        // {\n        //   \"_lctype\": 1,\n        //   \"_lctext\": \"小飞机关注了这个主播\",\n        //   \"_lcattrs\": {\n        //     \"user\": { \"id\": \"20032019\", \"name\": \"晨曦吻月\", \"role\": 9, \"avatar\": \"xxxxxx\" },\n        //     \"sm\": { \"type\": 0 },\n        //     \"gift\": { \"id\": 83743784138, \"number\": 12, \"totalFee\": 1200, \"anchorId\": \"726265\" },\n        //     \"rw\": { \"type\": 0, \"level\": 0, \"isJump\": 0 },\n        //     \"pType\": 0,\n        //     \"pid\": \"126712676\"\n        //   }\n        // },\n        // {\n        //   \"_lctype\": 1,\n        //   \"_lctext\": \"公告\",\n        //   \"_lcattrs\": {\n        //     \"user\": { \"id\": \"20032019\", \"name\": \"晨曦吻月\", \"role\": 9, \"avatar\": \"xxxxxx\" },\n        //     \"sm\": { \"type\": 1 },\n        //     \"gift\": { \"id\": 83743784138, \"number\": 12, \"totalFee\": 1200, \"anchorId\": \"726265\" },\n        //     \"rw\": { \"type\": 0, \"level\": 0, \"isJump\": 0 },\n        //     \"pType\": 0,\n        //     \"pid\": \"126712676\"\n        //   }\n        // },\n        // {\n        //   \"_lctype\": 5,\n        //   \"_lctext\": \"ban\",\n        //   \"_lcattrs\": {\n        //     \"user\": { \"id\": \"20032019\", \"name\": \"晨曦吻月\", \"role\": 9, \"avatar\": \"xxxxxx\" },\n        //     \"sm\": { \"type\": 0 },\n        //     \"gift\": { \"id\": 83743784138, \"number\": 12, \"totalFee\": 1200, \"anchorId\": \"726265\" },\n        //     \"rw\": { \"type\": 0, \"level\": 0, \"isJump\": 0 },\n        //     \"pType\": 0,\n        //     \"pid\": \"126712676\"\n        //   }\n        // },\n        // {\n        //   \"_lctype\": 1,\n        //   \"_lctext\": \"小飞机关注了这个主播\",\n        //   \"_lcattrs\": {\n        //     \"user\": { \"id\": \"20032019\", \"name\": \"晨曦吻月\", \"role\": 9, \"avatar\": \"xxxxxx\" },\n        //     \"sm\": { \"type\": 0 },\n        //     \"gift\": { \"id\": 83743784138, \"number\": 12, \"totalFee\": 1200, \"anchorId\": \"726265\" },\n        //     \"rw\": { \"type\": 0, \"level\": 0, \"isJump\": 0 },\n        //     \"pType\": 0,\n        //     \"pid\": \"126712676\"\n        //   }\n        // }\n      ], // 弹幕列表\n      danmaku: null, // 视频弹幕\n    };\n  },\n  computed: {\n    isLogin() {\n      return this.$store.getters.isLogin;\n    },\n    topNavStyleObj() {\n      if (this.isFold) {\n          return {\n            paddingLeft: `48px`,\n            width: `calc(100% - 48px)`,\n            minWidth: \"1132px\"\n          };\n        } else {\n          return {\n            paddingLeft: `240px`,\n            width: `calc(100% - 240px)`,\n            minWidth: \"948px\"\n          };\n        }\n    },\n    userStatus: {\n      get() {\n        return this.$store.state.userStatus;\n      },\n      set(val) {\n        return this.$store.commit(\"updateUserStatus\", val);\n      }\n    }\n  },\n  watch: {\n    $route() {\n      // 对路由变化作出响应\n      this.init();\n    }\n    // isLogin(value) {\n    //   // 监听登陆成功 组件暴露功能 暂未使用\n    //   if(value) this.init()\n    // }\n  },\n\n  created() {\n    // let sign = \"123*5\";\n    // let md5string = \"12345\";\n    //\n    // if (sign.indexOf(\"*\") > -1) {\n    //   console.log((sign = sign.split(\"*\")[0]), \"sign.split('*')[0]\");\n    //   console.log((md5string = md5string.slice(0, sign.length)), \"md5string\");\n    // }\n    // console.log(md5string === sign);\n    // document.cookie = 'xx-user-token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJ4LXp5LXVzZXItaWQiOiIzNDg2MDc0IiwiaXNzIjoiemhhbmd5dSIsImV4cCI6MTU3OTE1NDcyOCwiaWF0IjoxNTc3OTQ1MTI4fQ.fdWr8bgcExT3a7Qr8k-AMEF142FqK09RtqMWAHc4TECvJA7V_gD2F8v7UMsJKhbAspgWdN84byJfh3IALkg70w'\n    // Cookies.set('xx-user-token','eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJ4LXp5LXVzZXItaWQiOiIzNDg2MDc0IiwiaXNzIjoiemhhbmd5dSIsImV4cCI6MTU3OTE1NDcyOCwiaWF0IjoxNTc3OTQ1MTI4fQ.fdWr8bgcExT3a7Qr8k-AMEF142FqK09RtqMWAHc4TECvJA7V_gD2F8v7UMsJKhbAspgWdN84byJfh3IALkg70w')\n    this.init();\n    // setTimeout(() => {\n    //   this.msgList.push({\n    //     name: 111,\n    //     content: 222222\n    //   })\n    // },3000)\n\n    // test chatroom\n    // let index = 1;\n    // setInterval(() => {\n    //   console.log('msgList push');\n    //   this.msgList.push({\n    //     name: 111,\n    //     content: 222222+ index\n    //   })\n    //   index++\n    // },3000)\n\n    // test 礼物横幅\n    // let i = 1;\n    // let timer = setInterval(() => {\n    //   if (i == 10) clearInterval(timer);\n    //   this.giftItem = {\n    //     \"gift\": {\n    //       \"anchorId\": \"6919164\",\n    //       \"anchorName\": \"冯曦妤\",\n    //       \"id\": 12915206930636802,\n    //       \"name\": \"浪味仙\",\n    //       \"number\": 1,\n    //       \"picture\": \"https://pic.imifan.live/gifts/langXianXian/2019101819283913031452620677141.png\",\n    //       \"showGift\": true,\n    //       \"totalFee\": 10 * i\n    //     },\n    //     \"pType\": 0,\n    //     \"pid\": \"6919164\",\n    //     \"sign\": \"286403A393C275046C3053CA7EBE4ADD\",\n    //     \"user\": {\n    //       \"avatar\": \"https://pic.imifan.live/avatar/2019103119455113183057850163209.png\",\n    //       \"id\": \"3486074\",\n    //       \"name\": \"晨曦吻月\"\n    //     }\n    //   }\n    //   i++\n    //\n    //   console.log('setTimeout-----------------------');\n    //   this.getRank();\n    //\n    // }, 1000)\n\n    // test 跑道\n    // let i = 1;\n    // let timer = setInterval(() => {\n    //   if (i == 3) clearInterval(timer);\n    //   this.msgList.push({\"_lcattrs\":{\"gift\":{\"anchorId\":\"10007878\",\"anchorName\":\"小饭粒_10007878\",\"id\":\"12915206930636816\",\"name\":\"满汉全席\",\"number\":1,\"picture\":\"https://pic.imifan.live/gifts/manchu/2019101819301813031452620677143.png\",\"showGift\":true,\"totalFee\":200000},\"pType\":0,\"pid\":\"10007878\",\"sign\":\"B575A0DA78F8AB6A0A20D4D1546C8279\",\"user\":{\"avatar\":\"https://pic.imifan.live/avatar/2020011612283314054534902399033.jpg\",\"id\":\"6782355\",\"name\":\"fred\"}},\"_lctext\":\"12915206930636816\",\"_lctype\":2})\n    // this.messageItem = {\n    //   \"_lcattrs\": {\n    //     \"pType\": 1,\n    //     \"rw\": {\n    //       \"anchorId\": \"6144444\",\n    //       \"anchorName\": \"不朽少年梦\",\n    //       \"duration\": 10000,\n    //       \"isJump\": 1,\n    //       \"level\": 0,\n    //       \"name\": \"糖果庄园\",\n    //       \"number\": 2,\n    //       \"picture\": \"https://pic.imifan.live/gifts/fruitCastle/2019101819410313031452620677151.png\",\n    //       \"times\": 3,\n    //       \"type\": 1\n    //     },\n    //     \"sign\": \"64C3A3E27B5DB6DAFE1F3C46B6D9FEAE\",\n    //     \"user\": {\n    //       \"avatar\": \"https://pic.imifan.live/avatar/2019103119455113183057850163209.png\",\n    //       \"id\": \"3486074\",\n    //       \"name\": \"晨曦吻月\"\n    //     }\n    //   }, \"_lctext\": \"晨曦吻月赠送给主播不朽少年梦 2 个 糖果庄园！快来围观吧!\", \"_lctype\": 4\n    // }\n    //   i++\n    //\n    //   console.log('setTimeout');\n    //\n    // }, 1000)\n\n    // 封禁测试\n    // setTimeout(() => {\n    //   this.userInfo= {\n    //     channelRoleType: 2,\n    //     follow: false,\n    //     forbid: true,\n    //     forbidEndTime: 1577963587139\n    //   };\n    // },3000)\n\n    // 红包 测试\n    // this.hongbaoList.push({\"_lcattrs\":{\"pType\":0,\"sign\":\"37D9109E305705375A2960BEB3000222\",\"lcuid\":\"CHAT_USER_3506329\",\"pid\":\"10000157\",\"rp\":{\"time\":5000,\"id\":\"3506329\"}},\"_lctype\":3,\"_lctext\":\"主播早\"})\n  },\n\n  mounted() {\n    window.addEventListener(\"scroll\", this.handleScroll, true);\n    this.$nextTick(() => {\n      this.DanmakuInit();\n    });\n  },\n  destroyed() {\n    // 移除弹幕和resize监听\n    this.danmaku.destroy();\n    window.removeEventListener(\"resize\", this.danmakuResize);\n  },\n  methods: {\n    //滚动条\n    handleScroll() {\n      this.scrollTop = window.pageYOffset;\n      console.log(this.scrollTop);\n      if (this.scrollTop >= 700) {\n        this.videoshow = true;\n      } else {\n        this.videoshow = false;\n      }\n    },\n    getFoldState() {\n      // let leftFoldState = window.sessionStorage.getItem(\"leftFoldState\");\n      // this.isFold =\n      //   leftFoldState === null || leftFoldState === \"false\" ? false : true;\n      this.$nextTick(() => {\n        this.$refs.recommend.init();\n      });\n    },\n    DanmakuInit() {\n      this.danmaku = new Danmaku({\n        // 用于显示弹幕的「舞台」会被添加到该容器中\n        container: this.$refs.danmaku,\n        // container: this.$refs.dPlayer,\n        // container: document.querySelector('#danmaku'),\n        // container: document.querySelector('.video-player'),\n        // video: document.querySelector('.dplayer-video'),\n\n        // 弹幕数据数组，在 emit API 中会说明其格式\n        comments: [],\n\n        // 支持 DOM 引擎和 canvas 引擎。canvas 引擎一般比 DOM 更高效，但相对更耗内存。\n        // 默认为 DOM 引擎\n        // engine: 'canvas',\n\n        // 弹幕速度，也可以用 speed API 设置\n        speed: 105\n      });\n\n      // setInterval(() => {\n      //   this.danmaku.emit(comment);\n      // },200)\n      this.danmakuResize();\n      window.addEventListener(\"resize\", this.danmakuResize);\n    },\n    danmakuResize: debounce(\n      function() {\n        console.log(this.danmaku);\n        this.danmaku.resize();\n      },\n      200,\n      false\n    ),\n    /**\n     * 飘窗弹幕自己的type 对应三种字体\n     * 展示的消息类型：\n     * -1用户发送的消息、 #ffffff\n     * 1欢迎消息、关注消息、#FFC955\n     * 2抢红包消息 #FF7F64\n     * @param message\n     * @param type\n     */\n    sendDanmaku(message, type) {\n      let colorMap = {\n        \"-1\": \"#ffffff\",\n        1: \"#FFC955\",\n        2: \"#FF7F64\"\n      };\n      let comment = {\n        text: message,\n\n        // 默认为 rtl（从右到左），支持 ltr、rtl、top、bottom。\n        mode: \"rtl\",\n\n        // 在使用 DOM 引擎时，Danmaku 会为每一条弹幕创建一个 <div> 节点，\n        // 以下 CSS 样式会直接设置到 div.style 上\n        style: {\n          // top: '30px',\n          zIndex: 10,\n          fontSize: \"24px\",\n          fontWeight: \"700\",\n          opacity: \"0.84\",\n          lineHeight: \"33px\",\n          color: colorMap[type],\n          padding: \"4px 0\",\n          textShadow: \"1px 0px 1px rgba(34,34,34,1)\"\n        }\n\n        // 自定义渲染器\n        // 当 `render` 字段存在时, `text`, `html`, `style` 和 `canvasStyle` 将被忽略。\n\n        // 在使用 DOM 引擎时，该函数应当返回一个 HTMLElement。\n        // render: function() {\n        // var $div = document.createElement('div');\n        // var $img = document.createElement('img');\n        // $img.src = '/path/to/xxx.png';\n        // $div.appendChild($img);\n        // return $div;\n        // },\n        // 在使用 canvas 引擎时，该函数应当返回一个 HTMLCanvasElement。\n        // render: function() {\n        //   var canvas = document.createElement('canvas');\n        //   canvas.width = 320;\n        //   canvas.height = 180;\n        //   var ctx = canvas.getContext('2d');\n        //   ctx.beginPath();\n        //   ctx.arc(75, 75, 50, 0, 2 * Math.PI);\n        //   ctx.stroke();\n        //   return canvas;\n        // }\n      };\n      this.danmaku.emit(comment);\n    },\n    init() {\n      // 左侧边栏当前状态\n      // this.getFoldState();\n      console.log(6666);\n      this.liveroom = this.$route.params.liveroom;\n      // if (this.getChannelInfo instanceof Promise) {\n      //   console.log(\"yes Promise\");\n      // } else console.log(\"no Promise\");\n      this.getChannelInfo().then(()=>{\n          console.log(\"yes Promise\");\n          this.connetConversation();\n          this.getrecommendLiveList();\n      })      \n      this.getGiftList();\n      // this.getRanking();\n      this.getloginInfo();\n      this.enterRoom();\n    },\n    sendGiftSuccess(data) {\n      this.$set(this.userLogin, \"credit\", data.credit);\n    },\n    // 获取直播间信息\n    getloginInfo() {\n      if (!this.isLogin) return;\n      return loginInfo().then(res => {\n        this.userLogin = res.data;\n        // this.userStatus.userInfo.balance = res.data.accountDto.miCoin.balance\n        // console.log('this.userStatus.userInfo.balance',this.userStatus.userInfo.balance)\n        console.log(\"直播间-个人信息\", res);\n      });\n    },\n    // 当前用户进入直播间的信息\n    enterRoom() {\n      // if (!this.isLogin) return;\n      return enterRoom({ cid: this.liveroom }).then(res => {\n        this.userInfo = res.data;\n        console.log(res);\n      });\n    },\n    // 获取直播间信息\n    getChannelInfo() {\n    return channelInfo({ cid: this.liveroom }).then(res => {\n           this.channelInfo = res.data;\n           document.title = this.channelInfo.name;\n           console.log(112233);\n           console.log(res);\n        });\n    },\n    // 获取推荐列表\n    getrecommendLiveList() {\n      return recommendLiveList(\n        {\n          recommendAnchorType: \"SEARCH_PAGE\"\n          // size: 10,\n        },\n        {}\n      ).then(res => {\n        // 未开播\n        if (this.channelInfo.playStatusCode == 905) {\n          console.log('1')\n          this.recommendVideo2 = res.data.slice(0, 2);\n          this.recommendList = res.data.slice(2);\n        } else {\n          this.recommendList = res.data;\n        }\n        console.log(res);\n      });\n    },\n    // 礼物列表\n    getGiftList() {\n      return getGiftList().then(res => {\n        this.giftList = res.data;\n        // this.giftList = [res.data[0],res.data[0],res.data[0],res.data[0],res.data[0],res.data[0],res.data[0],res.data[0]];\n\n        res.data.forEach(item => {\n          this.$set(this.giftListToObject, item.id, item);\n        });\n        console.log(res);\n      });\n    },\n    // 榜单\n    getRanking() {\n      return queryRoomRanking({ anchorId: this.liveroom, type: 0 }).then(res => {\n        this.rankObject = res.data;\n      });\n    },\n    // 节流处理 更新榜单\n    getRank: debounce(\n      function() {\n        this.getRanking();\n      },\n      1000,\n      false\n    ),\n    // 弹幕初始化\n    connetConversation() {\n      var error;\n      // throw error;那我不知道你用yarn就有了\n      console.log(\"链接聊天室-用户信息\", this.userStatus);\n      let clientId = \"CHAT_VISITOR_\" + uuidv4();\n      if (this.isLogin) {\n        clientId = \"CHAT_USER_\" + this.userStatus.userInfo.uid;\n      }\n      console.log(\"链接聊天室clientId\", clientId);\n      Chat.getChatRoom(clientId, this.channelInfo.chatRooms[0]).then(\n        // test--加入签名\n        conversation => {\n          console.log(conversation, \"conversation\");\n          this.msgList.push({\n            _lctype: 1,\n            // _lctext: `欢迎来到秘饭直播${ this.channelInfo.uname }的直播间，监播人员将对直播间进行24小时巡查，禁止传播任何违法、违规、低俗、暴力等不良信息的行为。`\n            _lctext: `爱球禁止未成年人送礼等付费行为、严禁主播诱导未成年人消费。如直播间出现违法违规、色情低俗、赌博、诱导欺诈等行为，请及时举报。管理员24小时在线巡查并接受举报。`\n          });\n          // this.sendDanmaku(`欢迎来到秘饭直播${ this.channelInfo.uname }的直播间，直播间依法对直播内容进行24小时巡查，禁止任何传播违章、违规、低俗、暴力等不良信息的行为。`, 1)\n          try {\n            // 正常交互\n            conversation.on(event.MESSAGE, message => {\n              console.log(\"event.MESSAGE\", event.MESSAGE);\n              console.log(\"message\", message);\n              console.log(\"message.content\", message.content);\n              console.log(\n                message.content,\n                \"contentcontentcontentcontentcontent\"\n              );\n              console.log(\n                message.content._lctext,\n                \"messagemessagemessagemessagemessage\"\n              );\n              this.assignedMessage(message.content);\n            });\n            // // 弹出提示，告知当前用户的 clientId 在其他设备上登录了\n            conversation.on(event.CONFLICT, function() {\n              // TODO 互踢啦\n              console.log(\"互踢啦\");\n            });\n          } catch (error) {\n            console.log(\"弹幕服务器加载失败\");\n          }\n        }\n      );\n    },\n    // 分配弹幕返回数据\n    assignedMessage(message) {\n      let text = message._lctext;\n      let type = message._lctype;\n      let md5String = md5Secret(text);\n      let sign = message._lcattrs.sign;\n      /**\n       * 因为加密的字符串含有leanCloud的屏蔽词, 会被转化为*, 所以各个客户端需要增加以下逻辑\n       * 第一步: 判断字符串中是否包含*: 不包含直接对比\n       * 第二步: 如果包含*, 则判断*是否为第一个, 如果是第一个则不进行对比,直接展示\n       * 第三步: 如果不是第一个则切割字符串, 获取*前面的部分, 然后和本地截取相同长度然后在进行对比\n       */\n      if (sign.indexOf(\"*\") > -1) {\n        sign = sign.split(\"*\")[0];\n        md5String = md5String.slice(0, sign.length);\n\n        console.log(sign, \"sign\");\n        console.log(md5String, \"md5string\");\n      }\n      console.log(md5String === sign, \"md5String === sign\");\n      if (md5String === sign && md5String !== \"false\") {\n        console.log(\"receive message:\" + text);\n        // 弹幕文案\n        if (type === -1 || type === 1 || type === 2 || type === 5) {\n          this.msgList.push(JSON.parse(JSON.stringify(message)));\n        }\n        // 飘窗弹幕\n        if (type === -1) {\n          this.sendDanmaku(text, \"-1\");\n        }\n        if (type === 1) {\n          this.sendDanmaku(text, message._lcattrs.sm === 0 ? 2 : 1);\n        }\n        // 禁言 判断的是不是当前登陆用户\n        if (type === 5 && message._lcattrs.fb.uid === this.userLogin.id) {\n          this.enterRoom();\n        }\n        // 设置房管 判断的是不是当前登陆用户\n        if (type === 6 && message._lcattrs.manager.id === this.userLogin.id) {\n          this.enterRoom();\n        }\n        // 礼物\n        if (type === 2) {\n          this.giftItem = JSON.parse(JSON.stringify(message._lcattrs));\n          // this.getRank();\n        }\n        // 红包\n        if (type === 3) {\n          this.hongbaoList.push(JSON.parse(JSON.stringify(message)));\n        }\n        // 跑道\n        if (type === 4) {\n          this.messageItem = JSON.parse(JSON.stringify(message));\n        }\n      }\n    },\n    // 发送消息\n    sendMsg(msg) {\n      console.log(msg, \"sendMsg\");\n      let sign = md5Secret(msg);\n      let params = {\n        user: {\n          id: this.userLogin.id,\n          name: this.userLogin.uname,\n          role: this.userInfo.channelRoleType,\n          avatar: this.userLogin.avatarUrl\n        },\n        pType: 0,\n        pid: this.liveroom,\n        lcuid: `CHAT_USER_${this.userLogin.id}`,\n        sign\n      };\n      Chat.sendMsg(msg, params).then(() => {\n        console.log(\"success\");\n        this.msgList.push({\n          _lcattrs: {\n            user: {\n              role: this.userInfo.channelRoleType,\n              name: this.userLogin.uname,\n              id: this.userLogin.id,\n              avatar: this.userLogin.avatarUrl\n            }\n          },\n          _lctype: -1,\n          _lctext: msg\n        });\n        this.sendDanmaku(msg, \"-1\");\n      });\n    },\n    login() {\n      // 展示登陆弹窗\n      this.$refs.login.openLoginDialog();\n    }\n  }\n};\n</script>\n<style lang=\"scss\" scoped>\n@import \"@/assets/css/_index.scss\";\n\n.video-player {\n  /*position: absolute;*/\n  /*width: 100%;*/\n  /*height:100%;*/\n}\n\n.topNav {\n  position: fixed;\n  z-index: $z-index1;\n  top: 0;\n  left: 0;\n  width: 100%;\n  min-width: 948px;\n  padding-left: 240px;\n  // transition: all 0.5s;\n  background-color: #fff;\n}\n\n.main-header {\n  position: fixed;\n  z-index: 21;\n  top: 0;\n  left: 0;\n  width: 100%;\n\n  ::v-deep.home-nav {\n    /*width: calc(100% - 480px);*/\n    /*margin: 0 240px;*/\n    /*box-sizing:border-box;*/\n  }\n}\n\n.main-container {\n  padding-left: 240px;\n\n  &.fold {\n    padding-left: 48px;\n  }\n}\n\n.liveroom {\n  position: relative;\n  padding-top: 60px;\n  padding-right: 370px;\n\n  background-color: $bg-main;\n  @extend %clearfix;\n}\n\n.main-wrap {\n  margin: 20px 20px 20px 35px;\n  min-width: 535px;\n  // float:left;\n  display: flex;\n  flex-direction: column;\n}\n\n.chat-wrap {\n  position: fixed;\n  z-index: 3;\n  right: 0;\n  top: 80px;\n  overflow: hidden;\n  border-radius: 10px;\n  width: 370px;\n  height: 100%;\n\n  background-color: #fff;\n\n  border: 1px solid $color-border;\n  border-top: 0px solid $color-border;\n  border-right: 0px solid $color-border;\n}\n\n.empty {\n  position: relative;\n  /*height: 350px;*/\n  background-color: #ccc;\n  // hack 更改弹幕定位方式 保证视频在文档流内\n  & > ::v-deep div:not(:only-child):last-of-type {\n    position: absolute !important;\n    z-index: 19 !important;\n    top: 0 !important;\n    /*background-color: red!important;*/\n  }\n}\n</style>\n"]}]}