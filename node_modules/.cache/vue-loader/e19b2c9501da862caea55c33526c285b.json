{"remainingRequest":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/src/components/MCenter/Cropper.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/src/components/MCenter/Cropper.vue","mtime":1595570908558},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/cache-loader/dist/cjs.js","mtime":1595570902420},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/babel-loader/lib/index.js","mtime":1595570901804},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/cache-loader/dist/cjs.js","mtime":1595570902420},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/vue-loader/lib/index.js","mtime":1595570907990}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCiAgaW1wb3J0IHsgQnV0dG9uLCBEaWFsb2csIFVwbG9hZCwgTWVzc2FnZSB9IGZyb20gJ2VsZW1lbnQtdWknOwogIC8vaW1wb3J0IHsgdXBMb2FkRmlsZUJhc2V9IGZyb20gIkAvYXBpL21jZW50ZXJhcGkiOwogIGltcG9ydCB7IFZ1ZUNyb3BwZXIgfSBmcm9tICd2dWUtY3JvcHBlcic7CiAgZXhwb3J0IGRlZmF1bHQgewogICAgY29tcG9uZW50czogewogICAgICBbRGlhbG9nLm5hbWVdOiBEaWFsb2csCiAgICAgIFtVcGxvYWQubmFtZV06IFVwbG9hZCwKICAgICAgW0J1dHRvbi5uYW1lXTogQnV0dG9uLAogICAgICBbTWVzc2FnZS5uYW1lXTogTWVzc2FnZSwKICAgICAgVnVlQ3JvcHBlcgogICAgfSwKICAgIGRhdGEoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgICAgcHJldmlld3M6IHt9LAogICAgICAgIC8vIOijgeWJque7hOS7tueahOWfuuehgOmFjee9rm9wdGlvbgogICAgICAgIG9wdGlvbjogewogICAgICAgICAgaW1nOiAnJywgLy8g6KOB5Ymq5Zu+54mH55qE5Zyw5Z2ACiAgICAgICAgICBpbmZvOiB0cnVlLCAvLyDoo4HliarmoYbnmoTlpKflsI/kv6Hmga8KICAgICAgICAgIG91dHB1dFNpemU6IDAuOCwgLy8g6KOB5Ymq55Sf5oiQ5Zu+54mH55qE6LSo6YePCiAgICAgICAgICBvdXRwdXRUeXBlOiAnanBlZycsIC8vIOijgeWJqueUn+aIkOWbvueJh+eahOagvOW8jwogICAgICAgICAgY2FuU2NhbGU6IHRydWUsIC8vIOWbvueJh+aYr+WQpuWFgeiuuOa7mui9rue8qeaUvgogICAgICAgICAgYXV0b0Nyb3A6IHRydWUsIC8vIOaYr+WQpum7mOiupOeUn+aIkOaIquWbvuahhgogICAgICAgICAgLy8gYXV0b0Nyb3BXaWR0aDogNTAwLCAvLyDpu5jorqTnlJ/miJDmiKrlm77moYblrr3luqYKICAgICAgICAgIC8vIGF1dG9Dcm9wSGVpZ2h0OiA1MDAsIC8vIOm7mOiupOeUn+aIkOaIquWbvuahhumrmOW6pgogICAgICAgICAgZml4ZWRCb3g6IHRydWUsIC8vIOWbuuWumuaIquWbvuahhuWkp+WwjyDkuI3lhYHorrjmlLnlj5gKICAgICAgICAgIGZpeGVkOiB0cnVlLCAvLyDmmK/lkKblvIDlkK/miKrlm77moYblrr3pq5jlm7rlrprmr5TkvosKICAgICAgICAgIGZpeGVkTnVtYmVyOiBbMTAsIDEwXSwgLy8g5oiq5Zu+5qGG55qE5a696auY5q+U5L6LCiAgICAgICAgICBmdWxsOiB0cnVlLCAvLyDmmK/lkKbovpPlh7rljp/lm77mr5TkvovnmoTmiKrlm74KICAgICAgICAgIGNhbk1vdmVCb3g6IGZhbHNlLCAvLyDmiKrlm77moYbog73lkKbmi5bliqgKICAgICAgICAgIG9yaWdpbmFsOiBmYWxzZSwgLy8g5LiK5Lyg5Zu+54mH5oyJ54Wn5Y6f5aeL5q+U5L6L5riy5p+TCiAgICAgICAgICBjZW50ZXJCb3g6IGZhbHNlLCAvLyDmiKrlm77moYbmmK/lkKbooqvpmZDliLblnKjlm77niYfph4zpnaIKICAgICAgICAgIGluZm9UcnVlOiB0cnVlIC8vIHRydWUg5Li65bGV56S655yf5a6e6L6T5Ye65Zu+54mH5a696auYIGZhbHNlIOWxleekuueci+WIsOeahOaIquWbvuahhuWuvemrmAogICAgICAgIH0sCiAgICAgICAgcGljc0xpc3Q6IFtdLCAgLy/pobXpnaLmmL7npLrnmoTmlbDnu4QKICAgICAgICAvLyDpmLLmraLph43lpI3mj5DkuqQKICAgICAgICB1cmxhcGk6IHByb2Nlc3MuZW52LlZVRV9BUFBfWllfQVBJICsgIi9haXFpdS92MS91cExvYWQvZmlsZT91cGxvYWRUeXBlPUFWQVRBUiIsCiAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgdXBsb2FkSGVhZGVyczp7CgkJCQkJJ0NvbnRlbnQtVHlwZSc6ICdtdWx0aXBhcnQvZm9ybS1kYXRhJwogICAgICAgIH0sCgogICAgICAgIC8vCiAgICAgICAgaW1nczogW10sCgkJCQkvL+WIpOaWreWbvueJh+eahOexu+WeiwoJCQkJaW1nRGF0YTogewoJCQkJCWFjY2VwdDogJ2ltYWdlL2dpZiwgaW1hZ2UvanBlZywgaW1hZ2UvcG5nLCBpbWFnZS9qcGcnLAoJCQkJfQogICAgICB9CiAgICB9LAogICAgbWV0aG9kczogewogICAgICBiZWZvcmVVcGxvYWQoZmlsZSl7CiAgICAgICAgY29uc3QgaXNMdDJNID0gZmlsZS5zaXplIC8gMTAyNCAvIDEwMjQgPCAyOwogICAgICAgIGlmICghaXNMdDJNKSB7CiAgICAgICAgICBNZXNzYWdlLmVycm9yKCfkuIrkvKDlpLTlg4/lm77niYflpKflsI/kuI3og73otoXov4cgMk1CIScpCiAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9CiAgICAgICAgLy8g6L2sYmFzZTY0CiAgICAgICAgdGhpcy5nZXRCYXNlNjQoZmlsZSkudGhlbihyZXNCYXNlNjQgPT4gewogICAgICAgIC8vIHRoaXMuZmlsZUJhc2U2NCA9IHJlc0Jhc2U2NC5zcGxpdCgnLCcpWzFdLy/nm7TmjqXmi7/liLBiYXNlNjTkv6Hmga8KICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgICAgdGhpcy5vcHRpb24uaW1nID0gcmVzQmFzZTY0CiAgICAgICAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWUKICAgICAgICAgIH0pCiAgICAgICAgfSkKICAgICAgfSwKICAgICAgLy8g6I635Y+W5pys5Zyw5Zu+54mH6L2s5YyW5Li6YmFzZSA2NAogICAgICBnZXRCYXNlNjQoZmlsZSkgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICAgIGxldCBmaWxlUmVzdWx0ID0gIiI7CiAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbigpIHsvLyDlvIDlp4vovawKICAgICAgICAgICAgZmlsZVJlc3VsdCA9IHJlYWRlci5yZXN1bHQ7CiAgICAgICAgICB9CiAgICAgICAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uKGVycm9yKSB7Ly8g6L2sIOWksei0pQogICAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgICAgfQogICAgICAgICAgcmVhZGVyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uKCkgey8v6L2sIOe7k+adnyAg5ZKx5bCxIHJlc29sdmUg5Ye65Y67CiAgICAgICAgICAgIHJlc29sdmUoZmlsZVJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIC8vIOWunuaXtumihOiniOWHveaVsAogICAgICByZWFsVGltZShkYXRhKSB7CiAgICAgICAgY29uc29sZS5sb2coJ3JlYWxUaW1lJyk7CiAgICAgICAgdGhpcy5wcmV2aWV3cyA9IGRhdGEKICAgICAgfSwKCiAgICAgIC8vIOeCueWHu+ijgeWJqu+8jOi/meS4gOatpeaYr+WPr+S7peaLv+WIsOWkhOeQhuWQjueahOWcsOWdgAogICAgICBmaW5pc2goKSB7CiAgICAgICAgdGhpcy4kcmVmcy5jcm9wcGVyLmdldENyb3BEYXRhKChkYXRhKSA9PiB7CiAgICAgICAgICAvLyDlj6/og73pnIDopoHovaznoIHvvJ/vvJ/vvJ8KICAgICAgICAgIGxldCBmaWxlID0gZGF0YS5zbGljZShkYXRhLmluZGV4T2YoJywnKSArIDEpCiAgICAgICAgICBsZXQgZGF0YTIgPXsKICAgICAgICAgICAgICAiZmlsZSI6IGZpbGUsCiAgICAgICAgICAgICAgc2Vjb25kRGlyOiAic3RyaW5nIiwKICAgICAgICAgICAgICAidXBsb2FkVHlwZSI6ICJBVkFUQVIiCiAgICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuJGF4aW9zLnBvc3QocHJvY2Vzcy5lbnYuVlVFX0FQUF9aWV9BUEkgKyAiL2FpcWl1L3YxL2FwcC91cGxvYWQvZmlsZUJhc2UiLCBkYXRhMiwgewoJCQkJCWhlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogJ3RleHQvcGxhaW4nfQogICAgICAgICB9CiAgICAgICAgKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKCfliaroo4HlkI4t5LiK5LygcmVzcG9uc2UnLHJlc3BvbnNlKQogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PT0gMCkgewogICAgICAgICAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRhSW1nJywgcmVzcG9uc2UuZGF0YS5kYXRhWzBdKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICBNZXNzYWdlLmVycm9yKHJlc3BvbnNlLmRhdGEubXNnKQogICAgICAgICAgICB9CiAgICAgICAgfSkKCiAgICAgICAgLy8gICB1cExvYWRGaWxlQmFzZShkYXRhMikudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAvLyAgICAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PT0gMCkgewogICAgICAgIC8vICAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IGZhbHNlOwogICAgICAgIC8vICAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0YUltZycsIHJlc3BvbnNlLmRhdGEuZGF0YVswXSk7CiAgICAgICAgLy8gICAgIH0gZWxzZSB7CiAgICAgICAgLy8gICAgICAgIE1lc3NhZ2UuZXJyb3IocmVzcG9uc2UuZGF0YS5tc2cpCiAgICAgICAgLy8gICAgIH0KICAgICAgICAvLyAgfSkKCiAgICAgIH0pCiAgICB9LAogIH0KICB9Cg=="},{"version":3,"sources":["Cropper.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Cropper.vue","sourceRoot":"src/components/MCenter","sourcesContent":["<template>\n  <div class=\"ve-cropper\">\n    <el-upload class=\"upload-demo\" action='#' drag :headers=\"uploadHeaders\"\n               :with-credentials=\"true\" :before-upload=\"beforeUpload\" :show-file-list=\"false\">\n      <slot></slot>\n<!--            <i class=\"el-icon-upload\"></i>-->\n<!--      <img :src=\"require('@/assets/img/Mcenter-upload.png')\" class=\"upload\" alt=\"\">-->\n<!--      <div class=\"el-upload__text\">添加头像</div>-->\n<!--      <div class=\"el-upload__tip\" slot=\"tip\">请选择图片上传：支持JPG、PNG 等格式，图片需小于2M</div>-->\n    </el-upload>\n    <el-dialog title=\"图片剪裁\" :visible.sync=\"dialogVisible\" append-to-body>\n      <div class=\"cropper-content\">\n        <div class=\"cropper\" style=\"text-align:center\">\n          <vueCropper\n            ref=\"cropper\"\n            :img=\"option.img\"\n            :outputSize=\"option.size\"\n            :outputType=\"option.outputType\"\n            :info=\"true\"\n            :full=\"option.full\"\n            :canMove=\"option.canMove\"\n            :canMoveBox=\"option.canMoveBox\"\n            :original=\"option.original\"\n            :autoCrop=\"option.autoCrop\"\n            :fixed=\"option.fixed\"\n            :fixedNumber=\"option.fixedNumber\"\n            :centerBox=\"option.centerBox\"\n            :infoTrue=\"option.infoTrue\"\n            :fixedBox=\"option.fixedBox\"\n            @realTime=\"realTime\"\n          ></vueCropper>\n        </div>\n        <div style=\"width:260px;\">\n          <div class=\"show-preview\" :style=\"{'width': '200px', 'height':'200px'}\">\n            <div :style=\"previews.div\" class=\"preview\">\n                <img :src=\"previews.url\" :style=\"previews.img\">\n            </div>\n          </div>\n        </div>\n      </div>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"finish\" :loading=\"loading\">确认</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\n  import { Button, Dialog, Upload, Message } from 'element-ui';\n  //import { upLoadFileBase} from \"@/api/mcenterapi\";\n  import { VueCropper } from 'vue-cropper';\n  export default {\n    components: {\n      [Dialog.name]: Dialog,\n      [Upload.name]: Upload,\n      [Button.name]: Button,\n      [Message.name]: Message,\n      VueCropper\n    },\n    data() {\n      return {\n        dialogVisible: false,\n        previews: {},\n        // 裁剪组件的基础配置option\n        option: {\n          img: '', // 裁剪图片的地址\n          info: true, // 裁剪框的大小信息\n          outputSize: 0.8, // 裁剪生成图片的质量\n          outputType: 'jpeg', // 裁剪生成图片的格式\n          canScale: true, // 图片是否允许滚轮缩放\n          autoCrop: true, // 是否默认生成截图框\n          // autoCropWidth: 500, // 默认生成截图框宽度\n          // autoCropHeight: 500, // 默认生成截图框高度\n          fixedBox: true, // 固定截图框大小 不允许改变\n          fixed: true, // 是否开启截图框宽高固定比例\n          fixedNumber: [10, 10], // 截图框的宽高比例\n          full: true, // 是否输出原图比例的截图\n          canMoveBox: false, // 截图框能否拖动\n          original: false, // 上传图片按照原始比例渲染\n          centerBox: false, // 截图框是否被限制在图片里面\n          infoTrue: true // true 为展示真实输出图片宽高 false 展示看到的截图框宽高\n        },\n        picsList: [],  //页面显示的数组\n        // 防止重复提交\n        urlapi: process.env.VUE_APP_ZY_API + \"/aiqiu/v1/upLoad/file?uploadType=AVATAR\",\n        loading: false,\n        uploadHeaders:{\n\t\t\t\t\t'Content-Type': 'multipart/form-data'\n        },\n\n        //\n        imgs: [],\n\t\t\t\t//判断图片的类型\n\t\t\t\timgData: {\n\t\t\t\t\taccept: 'image/gif, image/jpeg, image/png, image/jpg',\n\t\t\t\t}\n      }\n    },\n    methods: {\n      beforeUpload(file){\n        const isLt2M = file.size / 1024 / 1024 < 2;\n        if (!isLt2M) {\n          Message.error('上传头像图片大小不能超过 2MB!')\n          return false\n        }\n        // 转base64\n        this.getBase64(file).then(resBase64 => {\n        // this.fileBase64 = resBase64.split(',')[1]//直接拿到base64信息\n          this.$nextTick(() => {\n            this.option.img = resBase64\n            this.dialogVisible = true\n          })\n        })\n      },\n      // 获取本地图片转化为base 64\n      getBase64(file) {\n        return new Promise((resolve, reject) => {\n          let reader = new FileReader();\n          let fileResult = \"\";\n          reader.readAsDataURL(file);\n          reader.onload = function() {// 开始转\n            fileResult = reader.result;\n          }\n          reader.onerror = function(error) {// 转 失败\n            reject(error);\n          }\n          reader.onloadend = function() {//转 结束  咱就 resolve 出去\n            resolve(fileResult);\n          }\n        });\n      },\n      // 实时预览函数\n      realTime(data) {\n        console.log('realTime');\n        this.previews = data\n      },\n\n      // 点击裁剪，这一步是可以拿到处理后的地址\n      finish() {\n        this.$refs.cropper.getCropData((data) => {\n          // 可能需要转码？？？\n          let file = data.slice(data.indexOf(',') + 1)\n          let data2 ={\n              \"file\": file,\n              secondDir: \"string\",\n              \"uploadType\": \"AVATAR\"\n            }\n          this.$axios.post(process.env.VUE_APP_ZY_API + \"/aiqiu/v1/app/upload/fileBase\", data2, {\n\t\t\t\t\theaders: {'Content-Type': 'text/plain'}\n         }\n        ).then(response => {\n          console.log('剪裁后-上传response',response)\n          if (response.data.code === 0) {\n              this.dialogVisible = false\n              this.$emit('updataImg', response.data.data[0])\n            } else {\n               Message.error(response.data.msg)\n            }\n        })\n\n        //   upLoadFileBase(data2).then((response) => {\n        //     if (response.data.code === 0) {\n        //       this.dialogVisible = false;\n        //       this.$emit('updataImg', response.data.data[0]);\n        //     } else {\n        //        Message.error(response.data.msg)\n        //     }\n        //  })\n\n      })\n    },\n  }\n  }\n</script>\n\n<style scoped>\n\n  .cropper-content {\n    display: flex;\n\n\n    display: -webkit-flex;\n    justify-content: space-around;\n    -webkit-justify-content: space-around;\n     align-items: center;\n  }\n\n  .cropper-content .cropper {\n    width: 260px;\n    height: 260px;\n  }\n\n  .cropper-content .show-preview {\n    flex: 1;\n    -webkit-flex: 1;\n    display: flex;\n    display: -webkit-flex;\n    justify-content: center;\n    -webkit-justify-content: center;\n    align-items: center;\n  }\n\n  .cropper-content .show-preview .preview {\n    overflow: hidden;\n    border-radius: 50%;\n    border: 1px solid #cccccc;\n    background: #cccccc;\n  }\n\n  .upload {\n    margin-top: 78px;\n    height: 52px;\n    width: 61px;\n  }\n  .el-upload__text {\n    margin-top: 4px;\n    font-size: 13px;\n    color: #797A82;\n  }\n  .el-upload__tip {\n    width: 211px;\n    font-size: 14px;\n    font-weight:400;\n    color:rgba(119,119,119,1);\n    line-height:20px;\n  }\n\n</style>\n\n\n<style>\n  .ve-cropper .el-upload-dragger {\n    width: 120px;\n    height: 120px;\n    border: 0 none;\n\n    /*background-color: #E9EAEC;*/\n  }\n  .el-upload-dragger .el-icon-upload {\n    font-size: 40px;\n  }\n  .ve-cropper .el-upload-dragger .el-icon-upload {\n    margin-top: -3px\n  }\n\n</style>\n"]}]}