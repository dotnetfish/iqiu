{"remainingRequest":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/src/components/liveroom/LiveroomBan.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/src/components/liveroom/LiveroomBan.vue","mtime":1595570908568},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/cache-loader/dist/cjs.js","mtime":1595570902420},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/babel-loader/lib/index.js","mtime":1595570901804},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/cache-loader/dist/cjs.js","mtime":1595570902420},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/vue-loader/lib/index.js","mtime":1595570907990}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8qCiog5Li75pKt5ZKM5oi/566h5peg5rOV56aB6KiA5bey6KKr56aB6KiA55qE5Lq677yM5o+Q56S64oCd6K+l55So5oi35bey6KKr56aB6KiACiog6LaF566h5Y+v5YaN5qyh56aB6KiA5bey6KKr56aB6KiA55qE55So5oi377yM5pWI5p6c5Li66KaG55uW5LmL5YmN55qE56aB6KiA5pe26Ze0Ciog56aB6KiA5ZCO6L6T5YWl5qGG6YOo5YiG5pi+56S656aB6KiA5pe26Ze077yM5LiU5peg5rOV6L6T5YWl5paH5a2X44CCCiogKi8KCmltcG9ydCB7IGZvcmJpZFVzZXIsIHNldE1hbmFnZXIgfSBmcm9tICdAL2FwaS9saXZlcm9vbSc7CmltcG9ydCB7IHRocm90dGxlIH0gZnJvbSAiQC91dGlscy9kZWJvdW5jZUFuZHRocm90dGxlIjsKaW1wb3J0IHsgU2VsZWN0LCBPcHRpb24sIEJ1dHRvbiB9IGZyb20gJ2VsZW1lbnQtdWknOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdMaXZlcm9vbUJhbicsCiAgcHJvcHM6IHsKICAgIHVzZXJJbmZvOiBPYmplY3QsIC8vIGNoYW5uZWxSb2xlVHlwZSAwKOaZrumAmueUqOaItyksIDEo5oi/566hKSwgMijkuLvmkq0pLCA5KOi2heeuoSkKICB9LAogIGNvbXBvbmVudHM6IHsKICAgIFtTZWxlY3QubmFtZV06IFNlbGVjdCwKICAgIFtPcHRpb24ubmFtZV06IE9wdGlvbiwKICAgIFtCdXR0b24ubmFtZV06IEJ1dHRvbiwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBvcHRpb25zOiBbCiAgICAgICAgewogICAgICAgICAga2V5OiA1LAogICAgICAgICAgdmFsdWU6ICIxMOWIhumSnyIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGtleTogNiwKICAgICAgICAgIHZhbHVlOiAiMzDliIbpkp8iCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBrZXk6IDcsCiAgICAgICAgICB2YWx1ZTogIjHlsI/ml7YiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBrZXk6IDEsCiAgICAgICAgICB2YWx1ZTogIjI05bCP5pe2IgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAga2V5OiA4LAogICAgICAgICAgdmFsdWU6ICIz5aSpIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAga2V5OiAyLAogICAgICAgICAgdmFsdWU6ICI35aSpIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAga2V5OiAzLAogICAgICAgICAgdmFsdWU6ICIzMOWkqSIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGtleTogOSwKICAgICAgICAgIHZhbHVlOiAiNuS4quaciCIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGtleTogNCwKICAgICAgICAgIHZhbHVlOiAi5rC45LmFIgogICAgICAgIH1dLCAvLyDnpoHoqIDnsbvlnos6IDAg5Y+W5raI56aB6KiAOyA1OjEw5YiG6ZKfLCA2OjMw5YiG6ZKfLCA3OjHlsI/ml7YsIDE6MjTlsI/ml7YsIDg6M+WkqSwgMjo35aSpLCAzOjMw5aSpLCA5OjbkuKrmnIgsIDQ65rC45LmFKDIw5bm0KQogICAgICBzZW5kaW5nOiBmYWxzZSwKICAgICAgYmFuRGlhbG9nOiBmYWxzZSwKICAgICAgcm9vbUJhbjogIiIsCiAgICAgIGFsbEJhbjogIiIsCiAgICAgIGJhbkxpc3Q6IFt7ICAvLyAwIOWPlua2iOemgeiogDsgNToxMOWIhumSnywgNjozMOWIhumSnywgNzox5bCP5pe2LCAxOjI05bCP5pe2LCA4OjPlpKksIDI6N+WkqSwgMzozMOWkqSwgOTo25Liq5pyILCA0OuawuOS5hSgyMOW5tCkKICAgICAgICB2YWx1ZTogMSwKICAgICAgICB0aXRsZTogJ+emgeiogDI05bCP5pe2JwogICAgICB9LCB7CiAgICAgICAgdmFsdWU6IDIsCiAgICAgICAgdGl0bGU6ICfnpoHoqIA35aSpJwogICAgICB9LCB7CiAgICAgICAgdmFsdWU6IDMsCiAgICAgICAgdGl0bGU6ICfnpoHoqIAzMOWkqScKICAgICAgfV0sCiAgICAgIGJhblVzZXJJbmZvOiB7fQogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICB9LAogIG1ldGhvZHM6IHsKICAgIHNob3coaXRlbSkgewogICAgICAvLyDmnYPpmZDkuI3otrMgKCDmnKrkvb/nlKjlvZPliY3nlKjmiLfooqvnpoHoqIAgfHwgdGhpcy51c2VySW5mby5mb3JiaWQpCiAgICAgIGlmICh0aGlzLnVzZXJJbmZvLmNoYW5uZWxSb2xlVHlwZSA9PT0gMCkgcmV0dXJuOwogICAgICB0aGlzLnJvb21CYW4gPSAiIjsKICAgICAgdGhpcy5hbGxCYW4gPSAiIjsKCiAgICAgIHRoaXMuYmFuRGlhbG9nID0gdHJ1ZTsKICAgICAgdGhpcy5iYW5Vc2VySW5mbyA9IGl0ZW07CiAgICAgIGNvbnNvbGUubG9nKGl0ZW0pOwogICAgfSwKICAgIGhhbmRsZUJhbjogdGhyb3R0bGUoZnVuY3Rpb24gKHZhbHVlLCBmb3JiaWRSb29tVHlwZSkgewogICAgICBjb25zb2xlLmxvZyh2YWx1ZSwgJ2JhbicpOwogICAgICBpZighdmFsdWUpIHsKICAgICAgICByZXR1cm4gdGhpcy5NZXNzYWdlLmVycm9yKHsKICAgICAgICAgIG1lc3NhZ2U6ICLor7fpgInmi6nnpoHoqIDlpKnmlbAiLAogICAgICAgIH0pCiAgICAgIH0KICAgICAgdGhpcy5zZW5kaW5nID0gdHJ1ZTsKICAgICAgcmV0dXJuIGZvcmJpZFVzZXIoewogICAgICAgIGJlRm9yYmlkVWlkOiB0aGlzLmJhblVzZXJJbmZvLl9sY2F0dHJzLnVzZXIuaWQsCiAgICAgICAgY2hhbm5lbElkOiB0aGlzLiRyb3V0ZS5wYXJhbXMubGl2ZXJvb20sCiAgICAgICAgZm9yYmlkVHlwZTogdmFsdWUsCiAgICAgICAgZm9yYmlkUm9vbVR5cGU6IGZvcmJpZFJvb21UeXBlCiAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgIHRoaXMuYmFuRGlhbG9nID0gZmFsc2U7CiAgICAgICAgdGhpcy5NZXNzYWdlLnN1Y2Nlc3MoewogICAgICAgICAgbWVzc2FnZTogcmVzLm1zZywKICAgICAgICB9KQogICAgICAgIHRoaXMuc2VuZGluZyA9IGZhbHNlOwogICAgICAgIHRoaXMucm9vbUJhbiA9ICIiOwogICAgICAgIHRoaXMuYWxsQmFuID0gIiI7CiAgICAgIH0pLmNhdGNoKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcy5kYXRhLm1zZykgdGhpcy5NZXNzYWdlLmVycm9yKHsKICAgICAgICAgIG1lc3NhZ2U6IHJlcy5kYXRhLm1zZywKICAgICAgICB9KQogICAgICAgIHRoaXMuc2VuZGluZyA9IGZhbHNlOwogICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgIH0pCiAgICB9LCAxMDAwKSwKICAgIGhhbmRsZVNldE1hbmFnZXI6IHRocm90dGxlKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICBjb25zb2xlLmxvZyh2YWx1ZSwgJ2JhbicpOwogICAgICB0aGlzLnNlbmRpbmcgPSB0cnVlOwogICAgICByZXR1cm4gc2V0TWFuYWdlcih7CiAgICAgICAgb3BlcmF0b3I6IHZhbHVlLCAvLyDmk43kvZw6MCDmt7vliqA7IDEg5Yig6ZmkCiAgICAgICAgdWlkOiB0aGlzLmJhblVzZXJJbmZvLl9sY2F0dHJzLnVzZXIuaWQKICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIHRoaXMuYmFuRGlhbG9nID0gZmFsc2U7CiAgICAgICAgdGhpcy5NZXNzYWdlLnN1Y2Nlc3MoewogICAgICAgICAgbWVzc2FnZTogcmVzLm1zZywKICAgICAgICB9KQogICAgICAgIHRoaXMuc2VuZGluZyA9IGZhbHNlOwogICAgICB9KS5jYXRjaChyZXMgPT4gewogICAgICAgIGlmIChyZXMuZGF0YS5tc2cpIHRoaXMuTWVzc2FnZS5lcnJvcih7CiAgICAgICAgICBtZXNzYWdlOiByZXMuZGF0YS5tc2csCiAgICAgICAgfSkKICAgICAgICB0aGlzLnNlbmRpbmcgPSBmYWxzZTsKICAgICAgfSkKICAgIH0sIDEwMDApLAogIH0KfQo="},{"version":3,"sources":["LiveroomBan.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LiveroomBan.vue","sourceRoot":"src/components/liveroom","sourcesContent":["<template>\n  <section>\n    <div class=\"ban-mask\" v-if=\"banDialog\" @click.stop.self=\"banDialog = false\">\n    </div>\n\n    <transition name=\"el-fade-in-linear\">\n      <div class=\"ban-wrap\" v-if=\"banDialog\">\n        <img :src=\"banUserInfo._lcattrs.user.avatar\" alt=\"\" class=\"ban-logo\">\n        <h3 class=\"ban-name\">{{ banUserInfo._lcattrs.user.name }}</h3>\n        <div class=\"ban-uid\">UID:{{ banUserInfo._lcattrs.user.id }}</div>\n        <!--        <div class=\"ban-btn\" @click.stop=\"handleBan(item.value)\" v-for=\"item in banList\" :key=\"item.value\">{{ item.title-->\n        <!--          }}-->\n        <!--        </div>-->\n        <div class=\"ban-btn\">\n          房间禁言：\n          <el-select v-model=\"roomBan\" style=\"width:100px;margin-right:10px;\" placeholder=\"请选择\" size=\"small\">\n            <el-option\n              v-for=\"item in options\"\n              :key=\"item.key\"\n              :label=\"item.value\"\n              :value=\"item.key\">\n            </el-option>\n          </el-select>\n          <el-button type=\"primary\" size=\"mini\" @click.stop=\"handleBan(roomBan, 0)\">确定</el-button>\n        </div>\n        <div class=\"ban-btn\" v-if=\"userInfo.channelRoleType===9\">\n          全站禁言：\n          <el-select v-model=\"allBan\" style=\"width:100px;margin-right:10px;\" placeholder=\"请选择\" size=\"small\">\n            <el-option\n              v-for=\"item in options\"\n              :key=\"item.key\"\n              :label=\"item.value\"\n              :value=\"item.key\">\n            </el-option>\n          </el-select>\n          <el-button type=\"primary\" size=\"mini\" @click.stop=\"handleBan(allBan, 1)\">确定</el-button>\n        </div>\n<!--        <div class=\"ban-btn\" v-if=\"userInfo.channelRoleType===9\" @click.stop=\"handleBan(4)\">全站永久禁言</div>-->\n        <div class=\"ban-btn\" v-if=\"userInfo.channelRoleType===2\" @click.stop=\"handleSetManager(0)\">设为房管</div>\n      </div>\n    </transition>\n  </section>\n</template>\n\n<script>\n  /*\n  * 主播和房管无法禁言已被禁言的人，提示”该用户已被禁言\n  * 超管可再次禁言已被禁言的用户，效果为覆盖之前的禁言时间\n  * 禁言后输入框部分显示禁言时间，且无法输入文字。\n  * */\n\n  import { forbidUser, setManager } from '@/api/liveroom';\n  import { throttle } from \"@/utils/debounceAndthrottle\";\n  import { Select, Option, Button } from 'element-ui';\n\n  export default {\n    name: 'LiveroomBan',\n    props: {\n      userInfo: Object, // channelRoleType 0(普通用户), 1(房管), 2(主播), 9(超管)\n    },\n    components: {\n      [Select.name]: Select,\n      [Option.name]: Option,\n      [Button.name]: Button,\n    },\n    data() {\n      return {\n        options: [\n          {\n            key: 5,\n            value: \"10分钟\"\n          },\n          {\n            key: 6,\n            value: \"30分钟\"\n          },\n          {\n            key: 7,\n            value: \"1小时\"\n          },\n          {\n            key: 1,\n            value: \"24小时\"\n          },\n          {\n            key: 8,\n            value: \"3天\"\n          },\n          {\n            key: 2,\n            value: \"7天\"\n          },\n          {\n            key: 3,\n            value: \"30天\"\n          },\n          {\n            key: 9,\n            value: \"6个月\"\n          },\n          {\n            key: 4,\n            value: \"永久\"\n          }], // 禁言类型: 0 取消禁言; 5:10分钟, 6:30分钟, 7:1小时, 1:24小时, 8:3天, 2:7天, 3:30天, 9:6个月, 4:永久(20年)\n        sending: false,\n        banDialog: false,\n        roomBan: \"\",\n        allBan: \"\",\n        banList: [{  // 0 取消禁言; 5:10分钟, 6:30分钟, 7:1小时, 1:24小时, 8:3天, 2:7天, 3:30天, 9:6个月, 4:永久(20年)\n          value: 1,\n          title: '禁言24小时'\n        }, {\n          value: 2,\n          title: '禁言7天'\n        }, {\n          value: 3,\n          title: '禁言30天'\n        }],\n        banUserInfo: {}\n      }\n    },\n    mounted() {\n    },\n    methods: {\n      show(item) {\n        // 权限不足 ( 未使用当前用户被禁言 || this.userInfo.forbid)\n        if (this.userInfo.channelRoleType === 0) return;\n        this.roomBan = \"\";\n        this.allBan = \"\";\n\n        this.banDialog = true;\n        this.banUserInfo = item;\n        console.log(item);\n      },\n      handleBan: throttle(function (value, forbidRoomType) {\n        console.log(value, 'ban');\n        if(!value) {\n          return this.Message.error({\n            message: \"请选择禁言天数\",\n          })\n        }\n        this.sending = true;\n        return forbidUser({\n          beForbidUid: this.banUserInfo._lcattrs.user.id,\n          channelId: this.$route.params.liveroom,\n          forbidType: value,\n          forbidRoomType: forbidRoomType\n        }).then(res => {\n          console.log(res);\n          this.banDialog = false;\n          this.Message.success({\n            message: res.msg,\n          })\n          this.sending = false;\n          this.roomBan = \"\";\n          this.allBan = \"\";\n        }).catch(res => {\n          if (res.data.msg) this.Message.error({\n            message: res.data.msg,\n          })\n          this.sending = false;\n          console.log(res);\n        })\n      }, 1000),\n      handleSetManager: throttle(function (value) {\n        console.log(value, 'ban');\n        this.sending = true;\n        return setManager({\n          operator: value, // 操作:0 添加; 1 删除\n          uid: this.banUserInfo._lcattrs.user.id\n        }).then(res => {\n          this.banDialog = false;\n          this.Message.success({\n            message: res.msg,\n          })\n          this.sending = false;\n        }).catch(res => {\n          if (res.data.msg) this.Message.error({\n            message: res.data.msg,\n          })\n          this.sending = false;\n        })\n      }, 1000),\n    }\n  }\n</script>\n\n<style scoped lang=\"scss\">\n  @import \"@/assets/css/_index.scss\";\n\n  .ban-mask {\n    position: fixed;\n    top: 0;\n    left: 0;\n    z-index: 29;\n    width: 100%;\n    height: 100%;\n    background-color: transparent;\n  }\n\n  .ban-wrap {\n    position: absolute;\n    top: 54px;\n    left: 50px;\n    z-index: 30;\n    width: 260px;\n    background: rgba(255, 255, 255, 1);\n    box-shadow: 0px 2px 16px 0px rgba(30, 32, 39, 0.11);\n    border-radius: 10px;\n    text-align: center;\n\n    .ban-btns {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n\n    .ban-logo {\n      margin-top: 15px;\n      margin-bottom: 8px;\n      width: 70px;\n      height: 70px;\n      border-radius: 50%;\n    }\n\n    .ban-name {\n      margin: 0;\n      font-size: 14px;\n      color: $color-title1;\n      @extend .bold;\n    }\n\n    .ban-uid {\n      margin-top: 7px;\n      margin-bottom: 7px;\n      font-size: 12px;\n      color: $color-title3;\n    }\n\n    .ban-btn {\n      margin: 0 12px;\n      height: 55px;\n      line-height: 55px;\n      font-size: 12px;\n      color: $color-main;\n      cursor: pointer;\n      border-bottom: 1px solid #F4F4F4;\n\n      &:nth-last-child(1) {\n        border-bottom: 0;\n        font-size: 14px;\n      }\n    }\n  }\n</style>\n"]}]}