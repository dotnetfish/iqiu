{"remainingRequest":"D:\\pc端clone\\iqiu\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc端clone\\iqiu\\src\\components\\video\\VueDplayerHls.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\pc端clone\\iqiu\\src\\components\\video\\VueDplayerHls.vue","mtime":1596177222525},{"path":"D:\\pc端clone\\iqiu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\pc端clone\\iqiu\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\pc端clone\\iqiu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\pc端clone\\iqiu\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KDQovLyBpbXBvcnQgSGxzIGZyb20gJ2hscy5qcycgLy8gaGxz5qih5byPLW0zdTjmtYENCmltcG9ydCBmbHZqcyBmcm9tICdmbHYuanMvZGlzdC9mbHYubWluLmpzJyAvLyBmbHbmtYHvvIwNCmltcG9ydCBEUGxheWVyIGZyb20gJ2RwbGF5ZXInDQppbXBvcnQgJ2RwbGF5ZXIvZGlzdC9EUGxheWVyLm1pbi5jc3MnDQppbXBvcnQgZWxlbWVudFJlc2l6ZURldGVjdG9yTWFrZXIgZnJvbSAnZWxlbWVudC1yZXNpemUtZGV0ZWN0b3InDQppbXBvcnQgc3RvcmFnZXMgZnJvbSAiQC91dGlscy9zdG9yYWdlLmpzIjsNCg0KIC8vIHdpbmRvdy5IbHMgPSBIbHMNCndpbmRvdy5mbHZqcyA9IGZsdmpzDQpleHBvcnQgZGVmYXVsdCB7DQogIHByb3BzOiB7DQogICAgdmlkZW86IHsNCiAgICAgIHR5cGU6IE9iamVjdA0KICAgIH0sDQogIH0sDQogIGRhdGEgKCkgew0KICAgIHJldHVybiB7DQogICAgICBkUGxheWVyOiBudWxsLA0KICAgICAgaGVpZ2h0OiAwDQogICAgfQ0KICB9LA0KICB3YXRjaDogew0KICAgIC8vIHZpZGVvOnsvL+a3seW6puebkeWQrO+8jOWPr+ebkeWQrOWIsOWvueixoeOAgeaVsOe7hOeahOWPmOWMlg0KICAgIC8vICAgaGFuZGxlcjpmdW5jdGlvbih2YWwsIG9sZFZhbCl7DQogICAgLy8gICAgIGNvbnNvbGUubG9nKCkNCiAgICAvLyAgICAgaWYodmFsLnVybCAhPT0nJyApew0KICAgIC8vICAgICAgY29uc29sZS5sb2coJ+aSreaUvuWZqC3nm5HlkKx2aWRlb+aWsCcsdmFsLCfnm5HlkKx2aWRlb+aWsCcsb2xkVmFsKQ0KICAgIC8vICAgICAgLy8gdGhpcy5kZXN0cm95UGxheWVyKCkNCiAgICAvLyAgICAgIHRoaXMuaW5pdERQbGF5ZXIoKQ0KICAgIC8vICAgICB9DQogICAgLy8gICB9LA0KICAgIC8vICAgZGVlcDp0cnVlIC8vdHJ1ZSDmt7Hluqbnm5HlkKwNCiAgICAvLyAgfQ0KICAgICAndmlkZW8ucGljJyAobmV3VmFsdWUpIHsNCiAgICAgICBjb25zb2xlLmxvZyhuZXdWYWx1ZSwnbmV3VmFsdWVuZXdWYWx1ZW5ld1ZhbHVlbmV3VmFsdWUnKTsNCiAgICAgICBpZihuZXdWYWx1ZSAhPT0gJycpew0KICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgdGhpcy5pbml0RFBsYXllcigpDQogICAgICAgICAgdGhpcy5saXN0ZW5FbGVtZW50d2lkdGgoJ2RwbGF5ZXIxJykNCiAgICAgICAgfSkNCiAgICAgIH1lbHNlIHsNCiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICAgIHRoaXMubGlzdGVuRWxlbWVudHdpZHRoKCdkcGxheWVyMicpDQogICAgICAgIH0pDQoNCiAgICAgIH0NCiAgICB9LA0KICB9LA0KICBtb3VudGVkICgpIHsNCiAgICBjb25zb2xlLmxvZygnd2luZG93Jyx3aW5kb3cpDQogICAgY29uc29sZS5sb2coJ2ZsdmpzJyxmbHZqcykNCiAgICBpZih0aGlzLnZpZGVvLnVybCAhPT0gJycpew0KICAgICAgdGhpcy5pbml0RFBsYXllcigpDQogICAgfWVsc2Ugew0KICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICB0aGlzLmxpc3RlbkVsZW1lbnR3aWR0aCgnZHBsYXllcjInKQ0KICAgICAgfSkNCiAgICB9DQogICAgLy8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRwbGF5ZXIxIikub25jb250ZXh0bWVudSA9IGZ1bmN0aW9uKCl7ICAvLyB0ZXN0IOWOu+aOieWPs+mUrg0KICAgIC8vICAgIHJldHVybiBmYWxzZTsNCiAgICAvLyB9DQogIH0sDQoNCiAgbWV0aG9kczogew0KICAgIGluaXREUGxheWVyICgpIHsNCiAgICAgIGNvbnNvbGUubG9nKCfmkq3mlL7lmajliJ3lp4vljJYnKQ0KICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkodGhpcy52aWRlbykpOw0KICAgICAgdGhpcy5kUGxheWVyID0gbmV3IERQbGF5ZXIoew0KICAgICAgICBjb250YWluZXI6IHRoaXMuJHJlZnMuZHBsYXllciwNCiAgICAgICAgbGl2ZTogdHJ1ZSwNCiAgICAgICAgYXV0b3BsYXk6IHRydWUsIC8vIOiHquWKqOaSreaUvg0KICAgICAgICB0aGVtZTogJyMxQkI1RUMnLA0KICAgICAgICBsb29wOiBmYWxzZSwgLy8g6KeG6aKR5b6q546v5pKt5pS+DQogICAgICAgIGxhbmc6ICd6aC1jbicsDQogICAgICAgIHNjcmVlbnNob3Q6IGZhbHNlLA0KICAgICAgICBob3RrZXk6IGZhbHNlLCAvLyDlvIDlkK/ng63plK7vvIzmlK/mjIHlv6vov5vjgIHlv6vpgIDjgIHpn7Pph4/mjqfliLbjgIHmkq3mlL7mmoLlgZwNCiAgICAgICAgcHJlbG9hZDogJ2F1dG8nLA0KICAgICAgICB2b2x1bWU6IDAuOCwNCiAgICAgICAgbXV0ZXg6IHRydWUsIC8vIOS6kuaWpe+8jOmYu+atouWkmuS4quaSreaUvuWZqOWQjOaXtuaSreaUvg0KICAgICAgICBjb250ZXh0bWVudTogJycsDQogICAgICAgIHZpZGVvOiB0aGlzLnZpZGVvDQogICAgICB9KQ0KDQogICAgICAvLyB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAvLyAgIGNvbnNvbGUubG9nKHRoaXMuJHJlZnMuZHBsYXllci5jbGllbnRXaWR0aCwgJ3d3d3ctdmlkZW8nKQ0KICAgICAgLy8gICBjb25zb2xlLmxvZyh0aGlzLmhlaWdodCA9IHRoaXMuJHJlZnMuZHBsYXllci5jbGllbnRXaWR0aCAvIDUgKiAzLCAnaGVpZ2h0JykNCiAgICAgIC8vIH0pDQogICAgICB0aGlzLmRQbGF5ZXIucGxheSgpDQogICAgICBjb25zb2xlLmxvZygn5pKt5pS+5Zmo5Yid5aeL5YyW5a6M5oiQJykNCiAgICAgIHRoaXMuaW5pdEV2ZW50cygpOw0KICAgIH0sDQogICAgZGVzdHJveVBsYXllcigpew0KICAgICAgY29uc29sZS5sb2coJ+mUgOavgeaSreaUvuWZqCcpDQogICAgICB0aGlzLmRQbGF5ZXIuZGVzdHJveSgpDQogICAgfSwNCiAgICBsaXN0ZW5FbGVtZW50d2lkdGggKGRvbSkgew0KICAgICAgIC8vIOebkeWQrC1kcGxheWVy5a695bqmDQogICAgICBsZXQgZXJkID0gZWxlbWVudFJlc2l6ZURldGVjdG9yTWFrZXIoKTsgIC8vIOW8leWFpWVsZW1lbnQtcmVzaXplLWRldGVjdG9yLOebkeWQrOWuveW6puWPmOWMlg0KICAgICAgbGV0IHRoYXQgPSB0aGlzOw0KICAgICAgZXJkLmxpc3RlblRvKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRvbSksIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdGhhdC4kbmV4dFRpY2soZnVuY3Rpb24gKCkgew0KICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLiRyZWZzLmRwbGF5ZXIuY2xpZW50V2lkdGgsICd2aWRlbycpDQogICAgICAgICAgaWYodGhpcy52aWRlby51cmwgIT09ICcnKXsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKDEyKQ0KICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy4kcmVmcy5kcGxheWVyLmNsaWVudFdpZHRoIC8gNSAqIDMsICd2aWRlby1oZWlnaHQnKQ0KICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLiRyZWZzLmRwbGF5ZXIuY2xpZW50V2lkdGggLyA1ICogMywgJ3ZpZGVvLWhlaWdodCcNCiAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKDIzKQ0KICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy4kcmVmcy5kcGxheWVyU3BlY2lhbC5jbGllbnRXaWR0aCAvIDUgKiAzLCAndmlkZW8taGVpZ2h0JykNCiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy4kcmVmcy5kcGxheWVyU3BlY2lhbC5jbGllbnRXaWR0aCAvIDUgKiAzLCAndmlkZW8taGVpZ2h0Jw0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgIH0pDQoNCiAgICB9LA0KICAgIGluaXRFdmVudHMgKCkgew0KICAgICAgdGhpcy5kUGxheWVyLm9uKCdwbGF5JywgKCkgPT4gew0KICAgICAgICB0aGlzLiRlbWl0KCdwbGF5JykNCiAgICAgIH0pDQogICAgICB0aGlzLmRQbGF5ZXIub24oJ3F1YWxpdHlfc3RhcnQnLCAocmVzKSA9PiB7DQogICAgICAgIHN0b3JhZ2VzLnNldEl0ZW0oJ3F1YWxpdHknLCByZXMuY29kZSkNCiAgICAgICAgdGhpcy4kZW1pdCgncXVhbGl0eV9zdGFydCcpDQogICAgICB9KQ0KICAgICAgdGhpcy5kUGxheWVyLm9uKCdwYXVzZScsICgpID0+IHsNCiAgICAgICAgdGhpcy4kZW1pdCgncGF1c2UnKQ0KICAgICAgfSkNCiAgICAgIHRoaXMuZFBsYXllci5vbignY2FucGxheScsICgpID0+IHsNCiAgICAgICAgdGhpcy4kZW1pdCgnY2FucGxheScpDQogICAgICB9KQ0KICAgICAgdGhpcy5kUGxheWVyLm9uKCdwbGF5aW5nJywgKCkgPT4gew0KICAgICAgICB0aGlzLiRlbWl0KCdwbGF5aW5nJykNCiAgICAgIH0pDQogICAgICB0aGlzLmRQbGF5ZXIub24oJ2VuZGVkJywgKCkgPT4gew0KICAgICAgICB0aGlzLiRlbWl0KCdlbmRlZCcpDQogICAgICB9KQ0KICAgICAgdGhpcy5kUGxheWVyLm9uKCdlcnJvcicsICgpID0+IHsNCiAgICAgICAgdGhpcy4kZW1pdCgnZXJyb3InKQ0KICAgICAgfSkNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["VueDplayerHls.vue"],"names":[],"mappings":";;;;;;AAMA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"VueDplayerHls.vue","sourceRoot":"src/components/video","sourcesContent":["<template>\r\n   <div v-if=\"video.url !== '' \" ref=\"dplayer\" class=\"dplayer\"  id=\"dplayer1\"  v-bind:style=\"{ height: height + 'px' }\"></div>\r\n   <div v-else ref=\"dplayerSpecial\" class=\"dplayer\"  id=\"dplayer2\"  v-bind:style=\"{ height: height + 'px' }\"></div>\r\n</template>\r\n\r\n<script>\r\n// import Hls from 'hls.js' // hls模式-m3u8流\r\nimport flvjs from 'flv.js/dist/flv.min.js' // flv流，\r\nimport DPlayer from 'dplayer'\r\nimport 'dplayer/dist/DPlayer.min.css'\r\nimport elementResizeDetectorMaker from 'element-resize-detector'\r\nimport storages from \"@/utils/storage.js\";\r\n\r\n // window.Hls = Hls\r\nwindow.flvjs = flvjs\r\nexport default {\r\n  props: {\r\n    video: {\r\n      type: Object\r\n    },\r\n  },\r\n  data () {\r\n    return {\r\n      dPlayer: null,\r\n      height: 0\r\n    }\r\n  },\r\n  watch: {\r\n    // video:{//深度监听，可监听到对象、数组的变化\r\n    //   handler:function(val, oldVal){\r\n    //     console.log()\r\n    //     if(val.url !=='' ){\r\n    //      console.log('播放器-监听video新',val,'监听video新',oldVal)\r\n    //      // this.destroyPlayer()\r\n    //      this.initDPlayer()\r\n    //     }\r\n    //   },\r\n    //   deep:true //true 深度监听\r\n    //  }\r\n     'video.pic' (newValue) {\r\n       console.log(newValue,'newValuenewValuenewValuenewValue');\r\n       if(newValue !== ''){\r\n        this.$nextTick(() => {\r\n          this.initDPlayer()\r\n          this.listenElementwidth('dplayer1')\r\n        })\r\n      }else {\r\n        this.$nextTick(() => {\r\n          this.listenElementwidth('dplayer2')\r\n        })\r\n\r\n      }\r\n    },\r\n  },\r\n  mounted () {\r\n    console.log('window',window)\r\n    console.log('flvjs',flvjs)\r\n    if(this.video.url !== ''){\r\n      this.initDPlayer()\r\n    }else {\r\n      this.$nextTick(() => {\r\n        this.listenElementwidth('dplayer2')\r\n      })\r\n    }\r\n    // document.getElementById(\"dplayer1\").oncontextmenu = function(){  // test 去掉右键\r\n    //    return false;\r\n    // }\r\n  },\r\n\r\n  methods: {\r\n    initDPlayer () {\r\n      console.log('播放器初始化')\r\n      console.log(JSON.stringify(this.video));\r\n      this.dPlayer = new DPlayer({\r\n        container: this.$refs.dplayer,\r\n        live: true,\r\n        autoplay: true, // 自动播放\r\n        theme: '#1BB5EC',\r\n        loop: false, // 视频循环播放\r\n        lang: 'zh-cn',\r\n        screenshot: false,\r\n        hotkey: false, // 开启热键，支持快进、快退、音量控制、播放暂停\r\n        preload: 'auto',\r\n        volume: 0.8,\r\n        mutex: true, // 互斥，阻止多个播放器同时播放\r\n        contextmenu: '',\r\n        video: this.video\r\n      })\r\n\r\n      // this.$nextTick(() => {\r\n      //   console.log(this.$refs.dplayer.clientWidth, 'wwww-video')\r\n      //   console.log(this.height = this.$refs.dplayer.clientWidth / 5 * 3, 'height')\r\n      // })\r\n      this.dPlayer.play()\r\n      console.log('播放器初始化完成')\r\n      this.initEvents();\r\n    },\r\n    destroyPlayer(){\r\n      console.log('销毁播放器')\r\n      this.dPlayer.destroy()\r\n    },\r\n    listenElementwidth (dom) {\r\n       // 监听-dplayer宽度\r\n      let erd = elementResizeDetectorMaker();  // 引入element-resize-detector,监听宽度变化\r\n      let that = this;\r\n      erd.listenTo(document.getElementById(dom), function () {\r\n        that.$nextTick(function () {\r\n        // console.log(this.$refs.dplayer.clientWidth, 'video')\r\n          if(this.video.url !== ''){\r\n            console.log(12)\r\n            console.log(this.$refs.dplayer.clientWidth / 5 * 3, 'video-height')\r\n            this.height = this.$refs.dplayer.clientWidth / 5 * 3, 'video-height'\r\n          }else{\r\n            console.log(23)\r\n            console.log(this.$refs.dplayerSpecial.clientWidth / 5 * 3, 'video-height')\r\n            this.height = this.$refs.dplayerSpecial.clientWidth / 5 * 3, 'video-height'\r\n          }\r\n        })\r\n      })\r\n\r\n    },\r\n    initEvents () {\r\n      this.dPlayer.on('play', () => {\r\n        this.$emit('play')\r\n      })\r\n      this.dPlayer.on('quality_start', (res) => {\r\n        storages.setItem('quality', res.code)\r\n        this.$emit('quality_start')\r\n      })\r\n      this.dPlayer.on('pause', () => {\r\n        this.$emit('pause')\r\n      })\r\n      this.dPlayer.on('canplay', () => {\r\n        this.$emit('canplay')\r\n      })\r\n      this.dPlayer.on('playing', () => {\r\n        this.$emit('playing')\r\n      })\r\n      this.dPlayer.on('ended', () => {\r\n        this.$emit('ended')\r\n      })\r\n      this.dPlayer.on('error', () => {\r\n        this.$emit('error')\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.dplayer{\r\n  width: 100%;\r\n  height: 100%;\r\n  padding: 0px;\r\n  background-color: #222;\r\n}\r\n</style>\r\n"]}]}