{"remainingRequest":"D:\\pc端clone\\iqiu\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc端clone\\iqiu\\src\\components\\video\\VueDplayerHls.vue?vue&type=style&index=0&id=87b89608&scoped=true&lang=css&","dependencies":[{"path":"D:\\pc端clone\\iqiu\\src\\components\\video\\VueDplayerHls.vue","mtime":1596177222525},{"path":"D:\\pc端clone\\iqiu\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\pc端clone\\iqiu\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\pc端clone\\iqiu\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\pc端clone\\iqiu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\pc端clone\\iqiu\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5kcGxheWVyew0KICB3aWR0aDogMTAwJTsNCiAgaGVpZ2h0OiAxMDAlOw0KICBwYWRkaW5nOiAwcHg7DQogIGJhY2tncm91bmQtY29sb3I6ICMyMjI7DQp9DQo="},{"version":3,"sources":["VueDplayerHls.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsJA;AACA;AACA;AACA;AACA;AACA","file":"VueDplayerHls.vue","sourceRoot":"src/components/video","sourcesContent":["<template>\r\n   <div v-if=\"video.url !== '' \" ref=\"dplayer\" class=\"dplayer\"  id=\"dplayer1\"  v-bind:style=\"{ height: height + 'px' }\"></div>\r\n   <div v-else ref=\"dplayerSpecial\" class=\"dplayer\"  id=\"dplayer2\"  v-bind:style=\"{ height: height + 'px' }\"></div>\r\n</template>\r\n\r\n<script>\r\n// import Hls from 'hls.js' // hls模式-m3u8流\r\nimport flvjs from 'flv.js/dist/flv.min.js' // flv流，\r\nimport DPlayer from 'dplayer'\r\nimport 'dplayer/dist/DPlayer.min.css'\r\nimport elementResizeDetectorMaker from 'element-resize-detector'\r\nimport storages from \"@/utils/storage.js\";\r\n\r\n // window.Hls = Hls\r\nwindow.flvjs = flvjs\r\nexport default {\r\n  props: {\r\n    video: {\r\n      type: Object\r\n    },\r\n  },\r\n  data () {\r\n    return {\r\n      dPlayer: null,\r\n      height: 0\r\n    }\r\n  },\r\n  watch: {\r\n    // video:{//深度监听，可监听到对象、数组的变化\r\n    //   handler:function(val, oldVal){\r\n    //     console.log()\r\n    //     if(val.url !=='' ){\r\n    //      console.log('播放器-监听video新',val,'监听video新',oldVal)\r\n    //      // this.destroyPlayer()\r\n    //      this.initDPlayer()\r\n    //     }\r\n    //   },\r\n    //   deep:true //true 深度监听\r\n    //  }\r\n     'video.pic' (newValue) {\r\n       console.log(newValue,'newValuenewValuenewValuenewValue');\r\n       if(newValue !== ''){\r\n        this.$nextTick(() => {\r\n          this.initDPlayer()\r\n          this.listenElementwidth('dplayer1')\r\n        })\r\n      }else {\r\n        this.$nextTick(() => {\r\n          this.listenElementwidth('dplayer2')\r\n        })\r\n\r\n      }\r\n    },\r\n  },\r\n  mounted () {\r\n    console.log('window',window)\r\n    console.log('flvjs',flvjs)\r\n    if(this.video.url !== ''){\r\n      this.initDPlayer()\r\n    }else {\r\n      this.$nextTick(() => {\r\n        this.listenElementwidth('dplayer2')\r\n      })\r\n    }\r\n    // document.getElementById(\"dplayer1\").oncontextmenu = function(){  // test 去掉右键\r\n    //    return false;\r\n    // }\r\n  },\r\n\r\n  methods: {\r\n    initDPlayer () {\r\n      console.log('播放器初始化')\r\n      console.log(JSON.stringify(this.video));\r\n      this.dPlayer = new DPlayer({\r\n        container: this.$refs.dplayer,\r\n        live: true,\r\n        autoplay: true, // 自动播放\r\n        theme: '#1BB5EC',\r\n        loop: false, // 视频循环播放\r\n        lang: 'zh-cn',\r\n        screenshot: false,\r\n        hotkey: false, // 开启热键，支持快进、快退、音量控制、播放暂停\r\n        preload: 'auto',\r\n        volume: 0.8,\r\n        mutex: true, // 互斥，阻止多个播放器同时播放\r\n        contextmenu: '',\r\n        video: this.video\r\n      })\r\n\r\n      // this.$nextTick(() => {\r\n      //   console.log(this.$refs.dplayer.clientWidth, 'wwww-video')\r\n      //   console.log(this.height = this.$refs.dplayer.clientWidth / 5 * 3, 'height')\r\n      // })\r\n      this.dPlayer.play()\r\n      console.log('播放器初始化完成')\r\n      this.initEvents();\r\n    },\r\n    destroyPlayer(){\r\n      console.log('销毁播放器')\r\n      this.dPlayer.destroy()\r\n    },\r\n    listenElementwidth (dom) {\r\n       // 监听-dplayer宽度\r\n      let erd = elementResizeDetectorMaker();  // 引入element-resize-detector,监听宽度变化\r\n      let that = this;\r\n      erd.listenTo(document.getElementById(dom), function () {\r\n        that.$nextTick(function () {\r\n        // console.log(this.$refs.dplayer.clientWidth, 'video')\r\n          if(this.video.url !== ''){\r\n            console.log(12)\r\n            console.log(this.$refs.dplayer.clientWidth / 5 * 3, 'video-height')\r\n            this.height = this.$refs.dplayer.clientWidth / 5 * 3, 'video-height'\r\n          }else{\r\n            console.log(23)\r\n            console.log(this.$refs.dplayerSpecial.clientWidth / 5 * 3, 'video-height')\r\n            this.height = this.$refs.dplayerSpecial.clientWidth / 5 * 3, 'video-height'\r\n          }\r\n        })\r\n      })\r\n\r\n    },\r\n    initEvents () {\r\n      this.dPlayer.on('play', () => {\r\n        this.$emit('play')\r\n      })\r\n      this.dPlayer.on('quality_start', (res) => {\r\n        storages.setItem('quality', res.code)\r\n        this.$emit('quality_start')\r\n      })\r\n      this.dPlayer.on('pause', () => {\r\n        this.$emit('pause')\r\n      })\r\n      this.dPlayer.on('canplay', () => {\r\n        this.$emit('canplay')\r\n      })\r\n      this.dPlayer.on('playing', () => {\r\n        this.$emit('playing')\r\n      })\r\n      this.dPlayer.on('ended', () => {\r\n        this.$emit('ended')\r\n      })\r\n      this.dPlayer.on('error', () => {\r\n        this.$emit('error')\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.dplayer{\r\n  width: 100%;\r\n  height: 100%;\r\n  padding: 0px;\r\n  background-color: #222;\r\n}\r\n</style>\r\n"]}]}