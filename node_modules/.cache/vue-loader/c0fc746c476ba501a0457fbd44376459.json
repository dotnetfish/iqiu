{"remainingRequest":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/src/components/video/VueDplayerHls.vue?vue&type=style&index=0&id=87b89608&scoped=true&lang=css&","dependencies":[{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/src/components/video/VueDplayerHls.vue","mtime":1596600781121},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/css-loader/dist/cjs.js","mtime":1595570903613},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1595570907990},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/postcss-loader/src/index.js","mtime":1595570906300},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/cache-loader/dist/cjs.js","mtime":1595570902420},{"path":"/Users/zj-db0720/work/sourcescode/projects/gitee/iqiu/node_modules/vue-loader/lib/index.js","mtime":1595570907990}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmRwbGF5ZXJ7CiAgd2lkdGg6IDEwMCU7CiAgaGVpZ2h0OiAxMDAlOwogIHBhZGRpbmc6IDBweDsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjMjIyOwp9Cg=="},{"version":3,"sources":["VueDplayerHls.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsJA;AACA;AACA;AACA;AACA;AACA","file":"VueDplayerHls.vue","sourceRoot":"src/components/video","sourcesContent":["<template>\n   <div v-if=\"video.url !== '' \" ref=\"dplayer\" class=\"dplayer\"  id=\"dplayer1\"  v-bind:style=\"{ height: height + 'px' }\"></div>\n   <div v-else ref=\"dplayerSpecial\" class=\"dplayer\"  id=\"dplayer2\"  v-bind:style=\"{ height: height + 'px' }\"></div>\n</template>\n\n<script>\n// import Hls from 'hls.js' // hls模式-m3u8流\nimport flvjs from 'flv.js/dist/flv.min.js' // flv流，\nimport DPlayer from 'dplayer'\nimport 'dplayer/dist/DPlayer.min.css'\nimport elementResizeDetectorMaker from 'element-resize-detector'\nimport storages from \"@/utils/storage.js\";\n\n // window.Hls = Hls\nwindow.flvjs = flvjs\nexport default {\n  props: {\n    video: {\n      type: Object\n    },\n  },\n  data () {\n    return {\n      dPlayer: null,\n      height: 0\n    }\n  },\n  watch: {\n    // video:{//深度监听，可监听到对象、数组的变化\n    //   handler:function(val, oldVal){\n    //     console.log()\n    //     if(val.url !=='' ){\n    //      console.log('播放器-监听video新',val,'监听video新',oldVal)\n    //      // this.destroyPlayer()\n    //      this.initDPlayer()\n    //     }\n    //   },\n    //   deep:true //true 深度监听\n    //  }\n     'video.pic' (newValue) {\n       console.log(newValue,'newValuenewValuenewValuenewValue');\n       if(newValue !== ''){\n        this.$nextTick(() => {\n          this.initDPlayer()\n          this.listenElementwidth('dplayer1')\n        })\n      }else {\n        this.$nextTick(() => {\n          this.listenElementwidth('dplayer2')\n        })\n\n      }\n    },\n  },\n  mounted () {\n    console.log('window',window)\n    console.log('flvjs',flvjs)\n    if(this.video.url !== ''){\n      this.initDPlayer()\n    }else {\n      this.$nextTick(() => {\n        this.listenElementwidth('dplayer2')\n      })\n    }\n    // document.getElementById(\"dplayer1\").oncontextmenu = function(){  // test 去掉右键\n    //    return false;\n    // }\n  },\n\n  methods: {\n    initDPlayer () {\n      console.log('播放器初始化')\n      console.log(JSON.stringify(this.video));\n      this.dPlayer = new DPlayer({\n        container: this.$refs.dplayer,\n        live: true,\n        autoplay: true, // 自动播放\n        theme: '#1BB5EC',\n        loop: false, // 视频循环播放\n        lang: 'zh-cn',\n        screenshot: false,\n        hotkey: false, // 开启热键，支持快进、快退、音量控制、播放暂停\n        preload: 'auto',\n        volume: 0.8,\n        mutex: true, // 互斥，阻止多个播放器同时播放\n        contextmenu: '',\n        video: this.video\n      })\n\n      // this.$nextTick(() => {\n      //   console.log(this.$refs.dplayer.clientWidth, 'wwww-video')\n      //   console.log(this.height = this.$refs.dplayer.clientWidth / 5 * 3, 'height')\n      // })\n      this.dPlayer.play()\n      console.log('播放器初始化完成')\n      this.initEvents();\n    },\n    destroyPlayer(){\n      console.log('销毁播放器')\n      this.dPlayer.destroy()\n    },\n    listenElementwidth (dom) {\n       // 监听-dplayer宽度\n      let erd = elementResizeDetectorMaker();  // 引入element-resize-detector,监听宽度变化\n      let that = this;\n      erd.listenTo(document.getElementById(dom), function () {\n        that.$nextTick(function () {\n        // console.log(this.$refs.dplayer.clientWidth, 'video')\n          if(this.video.url !== ''){\n            console.log(12)\n            console.log(this.$refs.dplayer.clientWidth / 5 * 3, 'video-height')\n            this.height = this.$refs.dplayer.clientWidth / 5 * 3, 'video-height'\n          }else{\n            console.log(23)\n            console.log(this.$refs.dplayerSpecial.clientWidth / 5 * 3, 'video-height')\n            this.height = this.$refs.dplayerSpecial.clientWidth / 5 * 3, 'video-height'\n          }\n        })\n      })\n\n    },\n    initEvents () {\n      this.dPlayer.on('play', () => {\n        this.$emit('play')\n      })\n      this.dPlayer.on('quality_start', (res) => {\n        storages.setItem('quality', res.code)\n        this.$emit('quality_start')\n      })\n      this.dPlayer.on('pause', () => {\n        this.$emit('pause')\n      })\n      this.dPlayer.on('canplay', () => {\n        this.$emit('canplay')\n      })\n      this.dPlayer.on('playing', () => {\n        this.$emit('playing')\n      })\n      this.dPlayer.on('ended', () => {\n        this.$emit('ended')\n      })\n      this.dPlayer.on('error', () => {\n        this.$emit('error')\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.dplayer{\n  width: 100%;\n  height: 100%;\n  padding: 0px;\n  background-color: #222;\n}\n</style>\n"]}]}